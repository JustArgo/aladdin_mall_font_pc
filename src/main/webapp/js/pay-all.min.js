!function(a){a.Common||(a.Common={}),a.Common.DataKeys||(a.Common.DataKeys={});var b=a.Ariel,c=function(){};b.override(c.prototype,{ACROSS_PAGES_PAY_REQUEST_DATA:"ACROSS_PAGES_PAY_REQUEST_DATA",ACROSS_PAGES_PAY_BUSINESS_DATA:"ACROSS_PAGES_PAY_BUSINESS_DATA",ACROSS_PAGES_BLANK_NOTE_STAGE_DATA:"ACROSS_PAGES_BLANK_NOTE_STAGE_DATA",ACROSS_PAGES_CLIENT_ENTRANCE_DATA:"ACROSS_PAGES_CLIENT_ENTRANCE_DATA",CACHE_PAY_BANKS_DATA:"CACHE_PAY_BANKS_DATA_2014110701",ACROSS_PAGES_DIRECT_DATA:"ACROSS_PAGES_DIRECT_DATA",ACROSS_PAGES_UNBIND_CARD_DATA:"ACROSS_PAGES_UNBIND_CARD_DATA",ACROSS_PAGES_PAYMENT_DATA:"ACROSS_PAGES_PAYMENT_DATA",ACROSS_PAGES_VERIFY_CODE_DATA:"ACROSS_PAGES_VERIFY_CODE_DATA",NEW_CARD_INFO_DATA:"NEW_CARD_INFO_DATA"}),a.Common.DataKeys=new c}(window),function(a){a.Common||(a.Common={}),a.Common.JSON||(a.Common.JSON={});var b=a.Ariel,c=function(){};b.override(c.prototype,{parse:function(a){return a?$.parseJSON(a):null}}),a.Common.JSON=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Net||(a.Common.Net={});var b=a.Ariel,c=function(){};b.override(c.prototype,{ajax:function(a){var b=this;return b._processUrl(a),b._processParameters(a),b._processSuccess(a),$.ajax(a)},_processUrl:function(a){1!=a.skipProcessUrl&&(/^\/pay\/.+$/.test(a.url)||(a.url="/newpay/"+a.url))},_processParameters:function(a){var b=this;b._setParameters(a,["appId","payId"]),a.data._format_="JSON"},_setParameters:function(a,c){for(var d=Ariel.parseGetParameters(),e=!0,f=c.length-1;f>=0;f--)d[c[f]]||(e=!1);if(a.data||(a.data={}),e){for(var g={},f=0;f<c.length;f++)g[c[f]]=d[c[f]],a.data[c[f]]=d[c[f]];Ariel.Courier._canStorage()&&Ariel.Courier.add(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA,JSON.stringify(g))}else{var h=Common.JSON.parse(b.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA));if(h)for(var f=0;f<c.length;f++)a.data[c[f]]=h[c[f]]}},_processSuccess:function(b){if(b.success){var c=b.success;b.success=function(b){return b.returnurl?void(a.location.href=b.returnurl):b.flag===!1?(Ariel.Components.Loading.hide(),void(a.location.href="error.html?type=1&description = "+b.info)):void c.call(this,b)}}}}),a.Common.Net=new c}(window),function(a){a.Common||(a.Common={}),a.Common.FinishPage||(a.Common.FinishPage={});var b=a.Ariel,c=function(){};b.override(c.prototype,{go:function(b,c){var b=b||{},c=c||{},d=Ariel.parseGetParameters()||{};for(var e in b)d[e]=b[e];var f="";for(var e in c)f=""==f?e+"="+c[e]:url+"&"+e+"="+c[e];Ariel.Components.Loading.show(),Common.Net.ajax({url:"getSuccessUrlInfo.action",data:d,success:function(b){Ariel.Components.Loading.hide(),b&&"0"==b.code&&(b.url?(b.url.indexOf("?")>0?b.url+="&"+f:b.url+="?"+f,a.location.href=b.url):a.location.href="finish.html?"+f)}})}}),a.Common.FinishPage=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){this._init(),this._initEvent()};b.override(c.prototype,{_maskTemplate:'<div class="COMM_MSGBOX_MASK"></div>',_template:'<div class="COMM_ID_VALIDATION_MSGBOX_WRAPPER">    <div class="COMM_ID_VALIDATION_MSGBOX">        <div class="COMM_ID_VALIDATION_MSGBOX_FORM">            <span class="COMM_ID_VALIDATION_MSGBOX_TIP">验证支付密码</span>             <div class="textfile COMM_ID_VALIDATION_MSGBOX_PASSWORD">                <input type="password" class="textfile-input COMM_ID_VALIDATION_MSGBOX_PASSWORD_INPUT" placeholder="请输入支付密码" />                <a href="javascript:void(0);"  class="switchtextfile-switch">                    <span class="switchtextfile-status switchtextfile-status-password"></span>                </a>            </div>            <span class="COMM_ID_VALIDATION_MSGBOX_PASSWORD_TIP"></span>            <a href="javascript:void(0)" class="COMM_ID_VALIDATION_MSGBOX_FORGET">忘记支付密码？</a>        </div>        <div class="COMM_ID_VALIDATION_MSGBOX_ACTION_WRAPPER">           <a href="javascript:void(0);" class="COMM_ID_VALIDATION_MSGBOX_CANCEL">取消</a>           <a href="javascript:void(0);" class="COMM_ID_VALIDATION_MSGBOX_OK COMM_ID_VALIDATION_MSGBOX_DISABLED">确定</a>        </div>    </div></div>',_mask:null,_wrapper:null,_viewport:null,_payType:null,_payAction:null,_payActionParameter:null,_txtPassword:null,_init:function(){var a=this;a._mask=$(a._maskTemplate),a._wrapper=$(a._template),a._viewport=$("#viewport")},_initEvent:function(){var c=this;c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_PASSWORD_INPUT").unbind("input keyup").bind("input keyup",function(){c._txtPassword.isValid()?c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_OK").removeClass("COMM_ID_VALIDATION_MSGBOX_DISABLED"):c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_OK").addClass("COMM_ID_VALIDATION_MSGBOX_DISABLED");var a=c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_PASSWORD_INPUT").val();a&&a.length>0&&c._txtPassword._wrapper.find(".textfile-reset").removeClass("textfile-reset-hide")}),c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_OK").click(function(){if(!$(this).hasClass("COMM_ID_VALIDATION_MSGBOX_DISABLED")){if(!c._txtPassword.isValid())return void c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_PASSWORD_TIP").text("请输入支付密码");Ariel.mpingEvent("JDCashierIousSecurityVerify_Sure",location.href),c.hide(),Ariel.Components.Loading.show(),Common.Net.ajax({url:c._payAction,type:"POST",data:c._getParameters(),success:function(a){Ariel.Components.Loading.hide(),"blank-note"==c._payType&&c._blankNoteCallBack.call(c,a),"coffer"==c._payType&&c._cofferCallBack.call(c,a)}})}}),c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_CANCEL").click(function(){c.hide(),Ariel.Components.Loading.hide()}),c._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_FORGET").click(function(){Ariel.mpingEvent("JDCashierIousSecurityVerify_ForgetPW",location.href);var c=Common.JSON.parse(b.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA)),d=c.appId,e=c.payId;c.sid?a.location.href="https://passport.m.jd.com/payPassword/validateFindPayPassword.action?urlFrom=1&sid="+c.sid:a.location.href="/newpay/jumpPage.action?appId="+d+"&payId="+e})},_blankNoteCallBack:function(a){var c=this;a.baiTiaoPayResult.isSuccess&&"1"==a.baiTiaoPayResult.tradeStatus?c._sendVerifyCode(a):a.baiTiaoPayResult.isSuccess&&1==a.baiTiaoPayResult.txnStatus?(c._validateAcrossPagesBlankNoteStageData(a),c._processFinishData(a)):b.Components.Pop.show(a.baiTiaoPayResult.info?a.baiTiaoPayResult.info:"系统异常")},_sendVerifyCode:function(c){var d=this;Common.Net.ajax({url:"baiTiaoSendCode.action",type:"POST",success:function(e){if(Ariel.Components.Loading.hide(),e.success){var f=d._payActionParameter;delete f.password;var g={payType:"blank-note",params:d._payActionParameter,tel:e.phone,data:c};b.Courier.add(Common.DataKeys.ACROSS_PAGES_VERIFY_CODE_DATA,JSON.stringify(g)),a.location.href="verify-code.html"}else b.Components.Pop.show(e.info)}})},_validateAcrossPagesBlankNoteStageData:function(a){var c={isValid:1,planText:a.baiTiaoPayResult.planText?a.baiTiaoPayResult.planText:"30天免息",price:a.baiTiaoPayResult.price?a.baiTiaoPayResult.price:"0",total:a.baiTiaoPayResult.total?a.baiTiaoPayResult.total:"0",stage:a.baiTiaoPayResult.installmentNum?a.baiTiaoPayResult.installmentNum:"1",repayDate:a.baiTiaoPayResult.repayDate};b.Courier.add(Common.DataKeys.ACROSS_PAGES_BLANK_NOTE_STAGE_DATA,JSON.stringify(c))},_cofferCallBack:function(a){var c=this;a.cofferPayResult.isSuccess&&1==a.cofferPayResult.txnStatus?c._processFinishData(a):b.Components.Pop.show(a.cofferPayResult.info)},_processFinishData:function(c){var d=Ariel.parseGetParameters();d.payId&&d.appId||(d=Common.JSON.parse(b.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA))),a.Common.FinishPage.go(d)},_saveClientEntranceData:function(a){b.Courier.add(Common.DataKeys.ACROSS_PAGES_CLIENT_ENTRANCE_DATA,JSON.stringify({showIcon:a.showIcon?"1":"0",showMIcon:a.showMIcon?"1":"0"}))},_getParameters:function(){var a=this,b=a._payActionParameter;b.password=a._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_PASSWORD_INPUT").val(),RSAUtils.setMaxDigits(131);var c=RSAUtils.getKeyPair(publicKey.po,"",publicKey.mu),d=b.password.split("").reverse().join("");return b.password=RSAUtils.encryptedString(c,d),b},show:function(a){var b=this;b._payType=a.payType,"blank-note"==b._payType&&(b._payAction="baiTiaoPayResult.action"),"coffer"==b._payType&&(b._payAction="doCofferPay.action"),b._payActionParameter=a.data,b._resetPassword(),b._hideForgetPassword(),b._viewport.append(b._mask),b._viewport.append(b._wrapper),b._txtPassword=new Common.Components.SwitchTextfile({selector:".COMM_ID_VALIDATION_MSGBOX .COMM_ID_VALIDATION_MSGBOX_PASSWORD",tap:!1})},_resetPassword:function(){var a=this;a._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_PASSWORD_INPUT").val("").attr("type","password"),a._wrapper.find(".switchtextfile-status").removeClass("switchtextfile-status-code").addClass("switchtextfile-status-password"),a._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_PASSWORD_TIP").text("")},_hideForgetPassword:function(){var a=this;"blank-note"==a._payType&&a._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_FORGET").show(),"coffer"==a._payType&&a._wrapper.find(".COMM_ID_VALIDATION_MSGBOX_FORGET").hide()},hide:function(){var a=this;a._wrapper.remove(),a._mask.remove()}}),a.Common.Components.IdValidationMsgBox=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){this._init(),this._initEvent()};b.override(c.prototype,{_maskTemplate:'<div class="password-box-mask"></div>',_template:'<div class="password-box-wrap">   <h6 class="password-box-title">请输入支付密码</h6>   <a href="javascript:void(0);" class="password-box-close"></a>   <p class="password-box-des default">您使用了虚拟资产,请进行验证</p>   <input class="password-box-input" maxlength="6" type="tel" pattern="[0-9]*" >   <a href="javascript:void(0);"" class="password-box-forget-tip">忘记密码</a></div>',_verifyWrapTemplate:'<div class="password-verify-wrap">  <div class="password-verifying"></div>  <p class="password-verify-description">验证支付密码</p></div>',_mask:null,_wrapper:null,_viewport:null,_payAction:null,_payActionParameter:null,_txtPassword:null,_verifyingWrapper:null,_init:function(){var a=this,b=navigator.userAgent;b.match(/(iPhone\sOS)\s([\d_]+)/)&&(a._template=a._template.replace('<div class="password-box-wrap">','<div class="password-box-wrap IOScompatible">')),a._mask=$(a._maskTemplate),a._wrapper=$(a._template),a._viewport=$("#viewport"),a._verifyingWrapper=$(a._verifyWrapTemplate)},_initEvent:function(){var c=this;c._wrapper.find(".password-box-input").bind("input propertychange",function(){var a=$(this),b=a.val();6==b.length&&(a.blur(),Ariel.mpingEvent("JDCashierIousSecurityVerify_Sure",location.href),c.hide(),c.showVerifyWrapper(),Common.Net.ajax({url:c._payAction,type:"POST",data:c._getParameters(),success:function(a){c.hideVerifyWrapper(),c._blankNoteCallBack.call(c,a)}}))}),c._wrapper.find(".password-box-forget-tip").click(function(){Ariel.mpingEvent("JDCashierIousSecurityVerify_ForgetPW",location.href);var c=Common.JSON.parse(b.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA)),d=c.appId,e=c.payId;c.sid?a.location.href="http://msc.jd.com/account/loginpage/wcoo/toSecurityPwd?source=4&sid="+c.sid:a.location.href="/newpay/jumpPage.action?appId="+d+"&payId="+e}),c._wrapper.find(".password-box-close").click(function(){c._resetPassword(),c.hide()})},_blankNoteCallBack:function(a){var c=this;a.baiTiaoPayResult.isSuccess&&"1"==a.baiTiaoPayResult.tradeStatus?c._sendVerifyCode(a):a.baiTiaoPayResult.isSuccess&&1==a.baiTiaoPayResult.txnStatus?(c._validateAcrossPagesBlankNoteStageData(a),c._processFinishData(a)):"0001"==a.baiTiaoPayResult.code?(c._viewport.append(c._mask),c._viewport.append(c._wrapper),c._wrapper.find(".password-box-input").focus(),c._wrapper.find(".password-box-input").val(""),c._wrapper.find(".password-box-des").removeClass("default").addClass("warning"),c._wrapper.find(".password-box-des").text(a.baiTiaoPayResult.info)):b.Components.Pop.show(a.baiTiaoPayResult.info)},_sendVerifyCode:function(c){var d=this;Common.Net.ajax({url:"baiTiaoSendCode.action",type:"POST",success:function(e){if(Ariel.Components.Loading.hide(),e.success){var f=d._payActionParameter;delete f.password;var g={payType:"blank-note",params:d._payActionParameter,tel:e.phone,data:c};b.Courier.add(Common.DataKeys.ACROSS_PAGES_VERIFY_CODE_DATA,JSON.stringify(g)),a.location.href="verify-code.html"}else b.Components.Pop.show(e.info)}})},_validateAcrossPagesBlankNoteStageData:function(a){var c;"1"==a.baiTiaoPayResult.flag?c={planText:a.baiTiaoPayResult.planText?a.baiTiaoPayResult.planText:"30天免息",price:a.baiTiaoPayResult.price?a.baiTiaoPayResult.price:"0",total:a.baiTiaoPayResult.total?a.baiTiaoPayResult.total:"0",stage:a.baiTiaoPayResult.installmentNum?a.baiTiaoPayResult.installmentNum:"1"}:(c=Common.JSON.parse(b.Courier.get(Common.DataKeys.ACROSS_PAGES_BLANK_NOTE_STAGE_DATA)),c.planText="30天免息"),c.isValid=1,c.repayDate=a.baiTiaoPayResult.repayDate,b.Courier.add(Common.DataKeys.ACROSS_PAGES_BLANK_NOTE_STAGE_DATA,JSON.stringify(c))},_processFinishData:function(c){var d=Ariel.parseGetParameters();d.payId&&d.appId||(d=Common.JSON.parse(b.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA))),a.Common.FinishPage.go(d)},_saveClientEntranceData:function(a){b.Courier.add(Common.DataKeys.ACROSS_PAGES_CLIENT_ENTRANCE_DATA,JSON.stringify({showIcon:a.showIcon?"1":"0",showMIcon:a.showMIcon?"1":"0"}))},_getParameters:function(){var a=this,b=a._payActionParameter;b.password=a._wrapper.find(".password-box-input").val(),RSAUtils.setMaxDigits(131);var c=RSAUtils.getKeyPair(publicKey.po,"",publicKey.mu),d=b.password.split("").reverse().join("");return b.password=RSAUtils.encryptedString(c,d),b},show:function(a){var b=this;if(b._payAction="baiTiaoPayResult.action",a&&(b._payActionParameter=a.data),b._payActionParameter.isUnPwd&&1==b._payActionParameter.isUnPwd)Ariel.Components.Loading.show(),Common.Net.ajax({url:b._payAction,type:"POST",data:b._getParameters(),success:function(a){Ariel.Components.Loading.hide(),b._blankNoteCallBack.call(b,a)}});else{var b=this;b._resetPassword(),b._viewport.append(b._mask),b._viewport.append(b._wrapper),b._wrapper.find(".password-box-input").focus()}},_resetPassword:function(){var a=this;a._wrapper.find(".password-box-input").val(""),a._wrapper.find(".password-box-des").removeClass("warning").addClass("default"),a._wrapper.find(".password-box-des").text("您使用了虚拟资产，请进行验证")},hide:function(){var a=this;a._wrapper.remove(),a._mask.remove()},showVerifyWrapper:function(){var a=this;a._viewport.append(a._mask),a._viewport.append(a._verifyingWrapper)},hideVerifyWrapper:function(){var a=this;a._mask.remove(),a._verifyingWrapper.remove()}}),a.Common.Components.sixDigitPasswordBox=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){this._init(),this._initEvent()};b.override(c.prototype,{_maskTemplate:'<div class="COMM_MSGBOX_MASK"></div>',_template:'<div class="COMM_MSGBOX_WRAPPER">    <div class="COMM_MSGBOX">        <div class="COMM_MSGBOX_FORM">            <span class="COMM_MSGBOX_TIP">支付确认</span>             <div>                <span class="COMM_MSGBOX_CONTENT">1、请在微信内完成支付，如果您已支付成功，请点击“已完成支付”按钮</span>                 <span class="COMM_MSGBOX_CONTENT2">2、如果您还未安装微信6.0.2 及以上版本客户端，请点击"取消"并选择其它支付方式付款</span>             </div>        </div>        <div class="COMM_MSGBOX_ACTION_WRAPPER">           <a href="javascript:void(0);" class="COMM_MSGBOX_CANCEL">取消</a>           <a href="javascript:void(0);" class="COMM_MSGBOX_OK">已完成支付</a>        </div>    </div></div>',_mask:null,_wrapper:null,_viewport:null,_prePayId:null,_finishData:null,_tid:null,_startPollTime:null,_pollNum:1,_pollQueryBetween:[10,5,5,5,5],_init:function(){var a=this;a._mask=$(a._maskTemplate),a._wrapper=$(a._template),a._viewport=$("#viewport")},_initEvent:function(){var a=this;a._wrapper.find(".COMM_MSGBOX_OK").click(function(){a._wrapper.find(".COMM_MSGBOX_OK").hasClass("COMM_MSGBOX_OK_DISABLE")||(Ariel.mpingEvent("MCashierWeChat_Paid"),a._wrapper.find(".COMM_MSGBOX_OK").addClass("COMM_MSGBOX_OK_DISABLE"),a._verifyTradeStatus())}),a._wrapper.find(".COMM_MSGBOX_CANCEL").click(function(){Ariel.mpingEvent("MCashierWeChat_Cancel"),a.hide()})},_verifyTradeStatus:function(){var c=this;Common.Net.ajax({url:"../index.action",type:"POST",skipProcessUrl:!0,data:{functionId:"wapWeiXinPayQueryForMobile",body:JSON.stringify({payId:c._finishData.jdPrePayId,payEnum:c._finishData.payEnum,time:""})},success:function(d){d.isSuccess?"1"!=d.payStatus?(c.hide(),b.Components.Pop.show(d.message?d.message:"订单还未完成付款，请您重新支付")):c._processFinishData(d):a.location.href="error.html?type=1&description="+(d.message?d.message:"系统异常")}})},_pollQueryPayResult:function(){var a=this;a._tid=setInterval(function(){var b=a._pollQueryBetween[a._pollNum-1],c=(new Date).valueOf();c-a._startPollTime<1e3*b||(a._startPollTime=c,Common.Net.ajax({url:"../index.action",type:"POST",skipProcessUrl:!0,data:{functionId:"wapWeiXinPayQueryForMobile",body:JSON.stringify({payId:a._finishData.jdPrePayId,payEnum:a._finishData.payEnum,time:a._pollNum+""})},success:function(b){return b.isSuccess&&"1"==b.payStatus?(a._pollNum=1,clearInterval(a._tid),void a._processFinishData(b)):(a._pollNum++,void(a._pollNum>a._pollQueryBetween.length&&(a._pollNum=1,clearInterval(a._tid))))}}))},400)},_setFinishData:function(a){this._finishData=a,this._startPollTime=(new Date).valueOf(),this._pollQueryPayResult(),this._pollNum=1},_processFinishData:function(b){var c=this;c.hide();var d=Ariel.parseGetParameters();a.Common.FinishPage.go(d,{_total:c._finishData._total})},show:function(a){var b=this;b._viewport.append(b._mask),b._viewport.append(b._wrapper),b._wrapper.find(".COMM_MSGBOX_OK").hasClass("COMM_MSGBOX_OK_DISABLE")&&b._wrapper.find(".COMM_MSGBOX_OK").removeClass("COMM_MSGBOX_OK_DISABLE")},hide:function(){var a=this;clearInterval(a._tid),a._wrapper.remove(),a._mask.remove()}}),a.Common.Components.WapPayMsgBox=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){this._init(),this._initEvent()};b.override(c.prototype,{_maskTemplate:'<div class="COMM_MSGBOX_MASK"></div>',_template:'<div class="COMM_MSGBOX_WRAPPER">    <div class="COMM_BACK_MSGBOX">        <div class="COMM_MSGBOX_FORM">            <span class="COMM_MSGBOX_TIP">确认要离开收银台？</span>             <div>                <span class="COMM_MSGBOX_CONTENT">下单后24小时订单将被取消，请尽快完成支付</span>             </div>        </div>        <div class="COMM_MSGBOX_ACTION_WRAPPER">           <a href="javascript:void(0);" class="COMM_MSGBOX_CANCEL">继续支付</a>           <a href="javascript:void(0);" class="COMM_MSGBOX_OK">确认离开</a>        </div>    </div></div>',_mask:null,_wrapper:null,_viewport:null,_init:function(){var a=this;a._mask=$(a._maskTemplate),a._wrapper=$(a._template),a._viewport=$("#viewport")},_initEvent:function(){var b=this;b._wrapper.find(".COMM_MSGBOX_OK").click(function(){a.location.href="http://home.m.jd.com/user/allOrders.action"}),b._wrapper.find(".COMM_MSGBOX_CANCEL").click(function(){b.hide()})},show:function(a){var b=this;a&&b._wrapper.find(".COMM_MSGBOX_CONTENT").html(a),b._viewport.append(b._mask),b._viewport.append(b._wrapper)},hide:function(){var a=this;a._wrapper.remove(),a._mask.remove()}}),a.Common.Components.GoBackMsgBox=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){var a=this;a._init(),a._initEvent()};b.override(c.prototype,{_BLANK_NOTE_LIST_ITEM_TEMPLATE:'<li class="COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM COMM_TOP_1PX_BORDER">    <a href="javascript:void(0);" data-discountAmount="{$discountAmount}" data-should-pay="{$should-pay}" data-stage="{$stage}" data-service-fee="{$service-fee}" data-down-payment="{$down-payment}" data-repayment="{$repayment}" data-total="{$total}" data-firstRepayDate ="{$firstRepayDate}" class="COM_CRL_RADIO COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE canChooseStage">     <div class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_MAIN">       <p class="si-staging">分{$stage}期</p><p class="si-rate">费率 {$rate}%/月</p>     </div>     <ul class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST">        <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">            <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">每期应还</span>            <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">{$repayment}元</span>        </li>        <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">            <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">每期服务费</span>            <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">{$service-fee}元</span>        </li>        <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">            <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">应还总额</span>            <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">{$total}元</span>        </li>     </ul>    </a></li>',_maskTemplate:'<div class="COMM_BLANK_NOTE_LAYER_MASK"></div>',_template:'   <div class="COMM_BLANK_NOTE_STAGE_LAYER">       <span class="select-panel-close" ></span>       <h2 class="selectStage-title">请选择分期</h2>       <div class="repayment-date">{$firstRepayDate}</div>       <ul class="COMM_BLANK_NOTE_STAGE_LAYER_LIST">       </ul>   </div>',_couponWrapTemplate:'  <div class="COMM_BLANK_NOTE_COUPON_LAYER selectCoupon-panel">      <span class="select-panel-close" ></span>      <div class="selectCoupon-title">          选择白条优惠</div>      <div class="selectCoupon-type">          <a class="selectCoupon-type-link available-coupon-link" href="javascript:void(0);"data-couponList="available-coupon">             <span class="coupon-link-words coupon-link-onShow">可用优惠</span></a>          <span class="right-border-1px"></span>          <a class="selectCoupon-type-link unavailable-coupon-link" href="javascript:void(0);" data-couponList="unavailable-coupon">             <span class="coupon-link-words">不可用优惠</span></a>      </div>      <div class="selectCoupon-list-wrap">          <ul class="selectCoupon-list available-coupon">          </ul>          <ul class="selectCoupon-list unavailable-coupon">          </ul>      </div>   </div>',_couponItemListTemplate:' <li class ="selectCoupon-list-item canUse-coupon-list-item COMM_TOP_1PX_BORDER">    <a href="javascript:void(0);" data-couponNum="{$couponNum}" data-discountAmount="{$discountAmount}" data-activityId={$activityId}  data-couponInfo ={$couponInfo} data-plans = {$data-plans} class="selectCoupon-list-item-link COM_CRL_RADIO">     <ul class="couponInfo-ul"><li class="coupon-title">{$couponInfo}</li>      <li class="coupon-descript">{$couponDesc}</li>      <li class="coupon-validity">有效期: {$startData}-{$deadline}</li></ul></a></li>',_firstCouponTemplate:'<li class ="selectCoupon-list-item canUse-coupon-list-item">    <a href="javascript:void(0);" data-couponNum="" data-activityId=""  data-couponInfo ="不使用优惠券" data-plans="1,3,6,12,24" class="selectCoupon-list-item-link COM_CRL_RADIO selectCoupon-use-no-coupon">    <ul class="couponInfo-ul"><li class="coupon-title">不使用优惠券</li></ul></a></li>',_couponGreyItemListTemplate:' <li class ="selectCoupon-list-item-grey COMM_TOP_1PX_BORDER">    <a href="javascript:void(0);" data-couponNum="{$couponNum}"  data-couponInfo ={$couponInfo} data-plans = {$data-plans} class="selectCoupon-list-item-link">    <ul class="couponInfo-grey-ul"><li class="coupon-title-grey">{$couponInfo}</li>    <li class="coupon-descript-grey">{$couponDesc}</li>    <li class="coupon-validity-grey">有效期: {$startData}-{$deadline}</li></ul></a></li>',_firstStageTemplate:'<li class="COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM">             <a href="javascript:void(0);" data-interestFreeDays="{$interestFreeDays}" data-stage="1" data-discountAmount="{$discountAmount}" data-should-pay="{$should-pay}" data-service-fee="0" data-down-payment="0" data-repayment="{$repayment}" data-firstRepayDate="{$firstRepayDate}"  data-total="{$total}" class="COM_CRL_RADIO COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE canChooseStage">             <div class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_MAIN">{$interestFreeDays}</div>               <ul class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST">                  <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">                     <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">应还金额</span>                     <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT  COMM_AFTER_DISCOUNT">{$repayment}元</span>                  </li>                  <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">                      <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">30天内一次还清</span>                      <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">0服务费</span>                   </li>                </ul>              </a>          </li>',_mask:null,_wrapper:null,_viewport:null,_couponWapper:null,_init:function(a){var b=this;b._mask=$(b._maskTemplate),b._wrapper=$(b._template),b._couponWapper=$(b._couponWrapTemplate),b._viewport=$("#viewport")},onInitCouponLayer:null,onSelectedStage:null,onSelectedCoupon:null,onUpdataStage:null,_updataBlankNoteStageList:function(a){var b,c,d=this,e=a.length,f=[],g=parseInt($(".choose-stage-bar").attr("data-stage")),h=$(".choose-stage-bar").attr("data-interestFreeDays"),i=$(".choose-coupon-bar").attr("data-plans").split(",");if(d._inArray(g,i)||(g=i[0]),e>0){for(var j=0;e>j;j++)b=a[j].plan,c=d._BLANK_NOTE_LIST_ITEM_TEMPLATE,0==j&&(c=d._firstStageTemplate),b==g?c=c.replace("COM_CRL_RADIO","COM_CRL_RADIO checked"):d._inArray(b,i)||(c=c.replace("canChooseStage","cantChooseStage")),c=c.replace("{$stage}",b),c=c.replace("{$stage}",b),c=c.replace("{$service-fee}",a[j].planFee),c=c.replace("{$service-fee}",a[j].planFee),c=c.replace("{$down-payment}",a[j].firstPay),c=c.replace("{$down-payment}",a[j].firstPay),c=c.replace("{$repayment}",a[j].laterPay),c=c.replace("{$repayment}",a[j].laterPay),c=c.replace("{$rate}",a[j].rate),c=c.replace("{$total}",a[j].total),c=c.replace("{$total}",a[j].total),c=c.replace("{$should-pay}",a[j].baiTiaoPayPrice),c=c.replace("{$discountAmount}",a[j].discountAmount),c=c.replace("{$firstRepayDate}",a[j].firstRepayDate),f.push(c);$(".COMM_BLANK_NOTE_STAGE_LAYER_LIST").html(f.join(""));var k=$(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE.checked"),l={stage:k.attr("data-stage"),serviceFee:k.attr("data-service-fee"),total:k.attr("data-total"),repayment:k.attr("data-repayment"),shouldPay:k.attr("data-should-pay"),discountAmount:k.attr("data-discountAmount"),isValid:0,interestFreeDays:h,repayDate:k.attr("data-firstRepayDate")};$(".repayment-date").html("（还款日 "+l.repayDate+"）"),null==d.onUpdataStage?d.onSelectedStage.call(d,l):d.onUpdataStage.call(d,l),Ariel.Components.Loading.hide()}},updataCouponLayer:function(a){var b=this;0==$(".COMM_BLANK_NOTE_COUPON_LAYER").length&&(b._viewport.append(b._couponWapper),a.canUseCouponList=a.canUseCouponList||[],a.cantUseCouponList=a.cantUseCouponList||[],this._initAvailableCouponList(a),this._initUnavailableCouponList(a.cantUseCouponList))},_initAvailableCouponList:function(a){var b=this;data=a.canUseCouponList,len=data.length,list=[],DAMost={discoutAmount:-1,couponOrder:0,useCoupon:"0"},stage=a.baiTiaoNum?a.baiTiaoNum:1,couponNumChoosed=a.couponCode?a.couponCode:"",activityIdChoosed=a.activityId?a.activityId:"";var c,d,e={};if(len>0){list.push(b._firstCouponTemplate);for(var f=0;f<len;f++){var g=data[f].activityId?data[f].activityId:"",h=data[f].couponNum?data[f].couponNum:"",i=data[f].discount?data[f].discount:0;c=b._couponItemListTemplate,c=c.replace("{$couponNum}",h),a.couponInfo&&"default"!=DAMost.useCoupon&&b._matchCoupon({couponNum:couponNumChoosed,activityId:activityIdChoosed},{couponNum:h,activityId:g})&&b._inArray(stage,data[f].plans)&&(DAMost.useCoupon="default",DAMost.couponOrder=f+1),"default"!=DAMost.useCoupon&&DAMost.discoutAmount<i&&b._inArray(stage,data[f].plans)&&(DAMost.discoutAmount=i,DAMost.couponOrder=f+1),c=c.replace("{$couponInfo}",data[f].couponInfo),c=c.replace("{$activityId}",g),c=c.replace("{$activityId}",g),c=c.replace("{$couponDesc}",data[f].couponDesc),c=c.replace("{$startData}",data[f].startTime),c=c.replace("{$deadline}",data[f].finishTime),c=c.replace("{$data-plans}",data[f].plans),c=c.replace("{$discountAmount}",data[f].discount),5!=data[f].plans.length?(d=data[f].couponInfo+"(限分"+data[f].plans.join("/")+"期使用)",d=d.replace("限分1/",a.interestFreeDays+"、分")):d=data[f].couponInfo,c=c.replace("{$couponInfo}",d),list.push(c)}if(list&&b._couponWapper.find(".available-coupon").append(list.join("")),DAMost.couponOrder>0){var j=data[DAMost.couponOrder-1];DAMost.useCoupon="match",e={useCoupon:!0,couponNum:j.couponNum,activityId:j.activityId,couponInfo:j.couponInfo,couponDesc:j.couponDesc,plans:j.plans,stage:stage,serviceFee:"",total:"",repayment:"",discountAmount:"",shouldPay:"",isValid:0}}"0"==DAMost.useCoupon&&(e={useCoupon:"0",couponNum:"",activityId:"",couponInfo:"不使用优惠券",couponDesc:"",plans:"1,3,6,12,24",stage:stage,serviceFee:"",discountAmount:"",total:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,repayment:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,shouldPay:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,isValid:0}),b._couponWapper.find(".canUse-coupon-list-item .selectCoupon-list-item-link").eq(DAMost.couponOrder).addClass("checked")}else b._couponWapper.find(".available-coupon").addClass("no-coupons"),b._couponWapper.find(".available-coupon").html('<li><span class="no-coupons-info">您还没有可用的优惠券</span></li>'),e={useCoupon:0,couponNum:"",activityId:"",couponInfo:"暂无可用优惠",couponDesc:"",plans:"1,3,6,12,24",stage:stage,serviceFee:"",total:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,repayment:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,shouldPay:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,isValid:0};(1!=stage||0!=DAMost.useCoupon)&&(Ariel.Components.Loading.show(),b.updataStageLayer(e)),b.onInitCouponLayer.call(b,e),b._firstStageTemplate=b._firstStageTemplate.replace("{$interestFreeDays}",a.interestFreeDays),b._firstStageTemplate=b._firstStageTemplate.replace("{$interestFreeDays}",a.interestFreeDays)},_initUnavailableCouponList:function(a){var b,c=this,d=a.length,e=[];if(d>0){for(var f=0;d>f;f++)b=c._couponGreyItemListTemplate,b=b.replace("{$couponNum}",a[f].couponNum),b=b.replace("{$data-plans}",a[f].plans),b=b.replace("{$couponInfo}",a[f].couponInfo),b=b.replace("{$couponInfo}",a[f].couponInfo),b=b.replace("{$couponDesc}",a[f].couponDesc),b=b.replace("{$startData}",a[f].startTime),b=b.replace("{$deadline}",a[f].finishTime),e.push(b);e&&(c._couponWapper.find(".unavailable-coupon").html(e.join("")),c._couponWapper.find(".selectCoupon-list-item-grey").eq(0).removeClass("COMM_TOP_1PX_BORDER"))}else c._couponWapper.find(".unavailable-coupon").html('<li><span class="no-coupons-info">您还没有不可用的优惠券</span></li>'),c._couponWapper.find(".unavailable-coupon").addClass("no-coupons")},_initEvent:function(){var a=this;a._wrapper.delegate(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE.canChooseStage","click",function(){var b=$(this),c={stage:b.attr("data-stage"),serviceFee:b.attr("data-service-fee"),total:b.attr("data-total"),repayment:b.attr("data-repayment"),shouldPay:b.attr("data-should-pay"),discountAmount:b.attr("data-discountAmount"),isValid:0,repayDate:b.attr("data-firstRepayDate")};a._wrapper.find(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE").removeClass("checked"),$(".repayment-date").html("（还款日 "+c.repayDate+"）"),b.addClass("checked"),null==a.onSelectedStage?a.onUpdataStage.call(a,c):a.onSelectedStage.call(a,c),a.hideStageLayer()}),a._couponWapper.delegate(".selectCoupon-list-item.canUse-coupon-list-item","click",function(){var c=$(this).find(".selectCoupon-list-item-link");if(c.hasClass("checked"))return void a.hideCouponLayer();var d={couponNum:c.attr("data-couponNum"),activityId:c.attr("data-activityId"),couponInfo:c.attr("data-couponInfo"),couponDesc:c.attr("data-couponDesc"),plans:c.attr("data-plans")};b.Components.Loading.show(),a.updataStageLayer(d,c)}),a._wrapper.delegate(".select-panel-close","click",function(){$(".COMM_BLANK_NOTE_STAGE_LAYER").removeClass("COM_LAYER_IN"),
$(".COMM_BLANK_NOTE_LAYER_MASK").hide()}),a._couponWapper.delegate(".select-panel-close","click",function(){$(".COMM_BLANK_NOTE_COUPON_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide()}),a._couponWapper.delegate(".selectCoupon-type-link","click",function(){var b=$(this),c=$(this).attr("data-couponList");a._couponWapper.find($(".selectCoupon-type-link")).find(".coupon-link-words").removeClass("coupon-link-onShow"),b.find(".coupon-link-words").addClass("coupon-link-onShow"),"available-coupon"==c&&($(".available-coupon").show(),$(".unavailable-coupon").hide()),"unavailable-coupon"==c&&($(".available-coupon").hide(),$(".unavailable-coupon").show())}),a._viewport.delegate(".COMM_BLANK_NOTE_LAYER_MASK","click",function(){$(".COMM_BLANK_NOTE_COUPON_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_STAGE_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide()})},updataStageLayer:function(a,c,d){var e=this,f={};f={couponCode:a.couponNum?a.couponNum:"",activityId:a.activityId?a.activityId:"",plans:$.isArray(a.plans)?a.plans.join(","):a.plans},0==$(".COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM").length&&e._viewport.append(e._wrapper),Common.Net.ajax({url:"calculateRate.action",type:"POST",data:f,success:function(g){0==g.code?(c&&e._switchCouponTo(a,c),e._updataBlankNoteStageList(g.payBillList),d&&e.showStageLayer()):Common.Net.ajax({url:"calculateRate.action",type:"POST",data:f,success:function(f){0==f.code?(c&&e._switchCouponTo(a,c),d&&e.showStageLayer(),e._updataBlankNoteStageList(f.payBillList)):(0==$(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE.checked").length&&e.intSeletBars(),b.Components.Pop.show(f.info?f.info:"获取白条信息失败，请重试"),Ariel.Components.Loading.hide())}})}})},showStageLayer:function(){var a=this;0==$(".COMM_BLANK_NOTE_STAGE_LAYER").length&&a._viewport.append(a._wrapper);var b=setTimeout(function(){0==$(".COMM_BLANK_NOTE_LAYER_MASK").length&&a._viewport.append(a._mask);var c=$(".COMM_BLANK_NOTE_STAGE_LAYER");Ariel.Components.Loading.hide(),c.addClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").show(),clearTimeout(b)},320)},hideStageLayer:function(){var a=$(".COMM_BLANK_NOTE_STAGE_LAYER"),b=setTimeout(function(){a.removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide(),clearTimeout(b)},500)},showCouponLayer:function(){var a=this;0==$(".COMM_BLANK_NOTE_LAYER_MASK").length&&a._viewport.append(a._mask),0==$(".COMM_BLANK_NOTE_COUPON_LAYER").length&&a._viewport.append(a._couponWapper);setTimeout(function(){Ariel.Components.Loading.hide();var a=$(".COMM_BLANK_NOTE_COUPON_LAYER");a.addClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").show(),clearTimeout(couponTD)},320)},hideCouponLayer:function(a){var b=$(".COMM_BLANK_NOTE_COUPON_LAYER"),c=this,d=setTimeout(function(){b.removeClass("COM_LAYER_IN"),a?c.showStageLayer():$(".COMM_BLANK_NOTE_LAYER_MASK").hide(),clearTimeout(d)},500)},_inArray:function(a,b){var c=b,d=parseInt(a);$.isArray(b)||(c=c.replace("[",""),c=c.replace("]",""),c=c.split(","));for(var e=0;e<c.length;e++)if(parseInt(c[e])==d)return!0;return!1},_matchCoupon:function(a,b){var c;return a.couponNum?c=a.couponNum.indexOf("nothing")<0?a.couponNum==b.couponNum?!0:!1:a.activityId&&a.activityId==b.activityId?!0:!1:!1},_switchCouponTo:function(a,b){var c=this,d=!0;c._inArray($(".choose-stage-bar").attr("data-stage"),a.plans)&&(d=!1),c._couponWapper.find(".selectCoupon-list-item-link").removeClass("checked"),b.addClass("checked"),c.onSelectedCoupon.call(c,a),c.hideCouponLayer(d)},intSeletBars:function(){var a=this;a._couponWapper.find(".selectCoupon-list-item-link").removeClass("checked"),coupondata={useCoupon:0,couponNum:"",activityId:"",couponInfo:"不使用优惠券",couponDesc:"",plans:"1,3,6,12,24"},a._couponWapper.find(".selectCoupon-use-no-coupon").addClass("checked"),a._wrapper.find(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE").eq(0).addClass("checked"),a.onInitCouponLayer(coupondata)}}),a.Common.Components.BlankNoteLayers=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){var a=this;a._init(),a._initEvent()};b.override(c.prototype,{_BLANK_NOTE_LIST_ITEM_TEMPLATE:'<li class="COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM COMM_TOP_1PX_BORDER">    <a href="javascript:void(0);" data-discountAmount="{$discountAmount}" data-should-pay="{$should-pay}" data-stage="{$stage}" data-service-fee="{$service-fee}" data-down-payment="{$down-payment}" data-repayment="{$repayment}" data-total="{$total}" data-firstRepayDate ="{$firstRepayDate}" class="COM_CRL_RADIO COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE canChooseStage">     <div class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_MAIN">       <p class="si-staging">分{$stage}期</p><p class="si-rate">费率 {$rate}%/月</p>     </div>     <ul class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST">        <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">            <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">每期应还</span>            <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">{$repayment}元</span>        </li>        <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">            <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">每期服务费</span>            <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">{$service-fee}元</span>        </li>        <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">            <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">应还总额</span>            <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">{$total}元</span>        </li>     </ul>    </a></li>',_maskTemplate:'<div class="COMM_BLANK_NOTE_LAYER_MASK"></div>',_template:'   <div class="COMM_BLANK_NOTE_STAGE_LAYER">       <span class="select-panel-close" ></span>       <h2 class="selectStage-title">请选择分期</h2>       <div class="repayment-date">{$firstRepayDate}</div>       <ul class="COMM_BLANK_NOTE_STAGE_LAYER_LIST">       </ul>   </div>',_couponWrapTemplate:'  <div class="COMM_BLANK_NOTE_COUPON_LAYER selectCoupon-panel">      <span class="select-panel-close" ></span>      <div class="selectCoupon-title">          选择白条优惠</div>      <div class="selectCoupon-type">          <a class="selectCoupon-type-link available-coupon-link" href="javascript:void(0);"data-couponList="available-coupon">             <span class="coupon-link-words coupon-link-onShow">可用优惠</span></a>          <span class="right-border-1px"></span>          <a class="selectCoupon-type-link unavailable-coupon-link" href="javascript:void(0);" data-couponList="unavailable-coupon">             <span class="coupon-link-words">不可用优惠</span></a>      </div>      <div class="selectCoupon-list-wrap">          <ul class="selectCoupon-list available-coupon">          </ul>          <ul class="selectCoupon-list unavailable-coupon">          </ul>      </div>   </div>',_couponItemListTemplate:' <li class ="selectCoupon-list-item canUse-coupon-list-item COMM_TOP_1PX_BORDER">    <a href="javascript:void(0);" data-couponNum="{$couponNum}" data-discountAmount="{$discountAmount}" data-activityId={$activityId}  data-couponInfo ={$couponInfo} data-plans = {$data-plans} data-activityType={$data-activityType} class="selectCoupon-list-item-link COM_CRL_RADIO">     <ul class="couponInfo-ul"><li class="coupon-title">{$couponInfo}</li>      <li class="coupon-descript">{$couponDesc}</li>      <li class="coupon-validity">有效期: {$startData}-{$deadline}</li></ul></a></li>',_firstCouponTemplate:'<li class ="selectCoupon-list-item canUse-coupon-list-item">    <a href="javascript:void(0);" data-couponNum="" data-activityId="" data-activityType=""  data-couponInfo ="不使用优惠券" data-plans="1,3,6,12,24" class="selectCoupon-list-item-link COM_CRL_RADIO selectCoupon-use-no-coupon">    <ul class="couponInfo-ul"><li class="coupon-title">不使用优惠券</li></ul></a></li>',_couponGreyItemListTemplate:' <li class ="selectCoupon-list-item-grey COMM_TOP_1PX_BORDER">    <a href="javascript:void(0);" data-couponNum="{$couponNum}"  data-couponInfo ={$couponInfo} data-plans = {$data-plans} class="selectCoupon-list-item-link">    <ul class="couponInfo-grey-ul"><li class="coupon-title-grey">{$couponInfo}</li>    <li class="coupon-descript-grey">{$couponDesc}</li>    <li class="coupon-validity-grey">有效期: {$startData}-{$deadline}</li></ul></a></li>',_firstStageTemplate:'<li class="COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM">             <a href="javascript:void(0);" data-interestFreeDays="{$interestFreeDays}" data-stage="1" data-discountAmount="{$discountAmount}" data-should-pay="{$should-pay}" data-service-fee="0" data-down-payment="0" data-repayment="{$repayment}" data-firstRepayDate="{$firstRepayDate}"  data-total="{$total}" class="COM_CRL_RADIO COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE canChooseStage">             <div class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_MAIN">{$interestFreeDays}</div>               <ul class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST">                  <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">                     <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">应还金额</span>                     <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT  COMM_AFTER_DISCOUNT">{$repayment}元</span>                  </li>                  <li class="COMM_BLANK_NOTE_STAGE_LAYER_DETAIL_LIST_ITEM">                      <span class="COMM_BLANK_NOTE_STAGE_LAYER_TITLE_VICE">30天内一次还清</span>                      <span class="COMM_BLANK_NOTE_STAGE_LAYER_AMOUNT">0服务费</span>                   </li>                </ul>              </a>          </li>',_mask:null,_wrapper:null,_viewport:null,_couponWapper:null,_init:function(a){var b=this;b._mask=$(b._maskTemplate),b._wrapper=$(b._template),b._couponWapper=$(b._couponWrapTemplate),b._viewport=$("#viewport")},onInitCouponLayer:null,onSelectedStage:null,onSelectedCoupon:null,onUpdataStage:null,_updataBlankNoteStageList:function(a){var b,c,d=this,e=a.length,f=[],g=parseInt($(".choose-stage-bar").attr("data-stage")),h=$(".choose-stage-bar").attr("data-interestFreeDays"),i=$(".choose-coupon-bar").attr("data-plans").split(",");if(d._inArray(g,i)||(g=i[0]),e>0){for(var j=0;e>j;j++)b=a[j].plan,c=d._BLANK_NOTE_LIST_ITEM_TEMPLATE,0==j&&(c=d._firstStageTemplate),b==g?c=c.replace("COM_CRL_RADIO","COM_CRL_RADIO checked"):d._inArray(b,i)||(c=c.replace("canChooseStage","cantChooseStage")),c=c.replace("{$stage}",b),c=c.replace("{$stage}",b),c=c.replace("{$service-fee}",a[j].planFee),c=c.replace("{$service-fee}",a[j].planFee),c=c.replace("{$down-payment}",a[j].firstPay),c=c.replace("{$down-payment}",a[j].firstPay),c=c.replace("{$repayment}",a[j].laterPay),c=c.replace("{$repayment}",a[j].laterPay),c=c.replace("{$rate}",a[j].rate),c=c.replace("{$total}",a[j].total),c=c.replace("{$total}",a[j].total),c=c.replace("{$should-pay}",a[j].baiTiaoPayPrice),c=c.replace("{$discountAmount}",a[j].discountAmount),c=c.replace("{$firstRepayDate}",a[j].firstRepayDate),f.push(c);$(".COMM_BLANK_NOTE_STAGE_LAYER_LIST").html(f.join(""));var k=$(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE.checked"),l={stage:k.attr("data-stage"),serviceFee:k.attr("data-service-fee"),total:k.attr("data-total"),repayment:k.attr("data-repayment"),shouldPay:k.attr("data-should-pay"),discountAmount:k.attr("data-discountAmount"),isValid:0,interestFreeDays:h,repayDate:k.attr("data-firstRepayDate")};$(".repayment-date").html("（还款日 "+l.repayDate+"）"),null==d.onUpdataStage?d.onSelectedStage.call(d,l):d.onUpdataStage.call(d,l),Ariel.Components.Loading.hide()}},updataCouponLayer:function(a){var b=this;0==$(".COMM_BLANK_NOTE_COUPON_LAYER").length&&(b._viewport.append(b._couponWapper),a.canUseCouponList=a.canUseCouponList||[],a.cantUseCouponList=a.cantUseCouponList||[],this._initAvailableCouponList(a),this._initUnavailableCouponList(a.cantUseCouponList))},_initAvailableCouponList:function(a){var b=this;data=a.canUseCouponList,len=data.length,list=[],DAMost={discoutAmount:-1,couponOrder:0,useCoupon:"0"},stage=a.baiTiaoNum?a.baiTiaoNum:1,couponNumChoosed=a.couponCode?a.couponCode:"",activityIdChoosed=a.activityId?a.activityId:"";var c,d,e={};if(len>0){list.push(b._firstCouponTemplate);for(var f=0;f<len;f++){var g=data[f].activityId?data[f].activityId:"",h=data[f].couponNum?data[f].couponNum:"",i=data[f].discount?data[f].discount:0;c=b._couponItemListTemplate,c=c.replace("{$couponNum}",h),a.couponInfo&&"default"!=DAMost.useCoupon&&b._matchCoupon({couponNum:couponNumChoosed,activityId:activityIdChoosed},{couponNum:h,activityId:g})&&b._inArray(stage,data[f].plans)&&(DAMost.useCoupon="default",DAMost.couponOrder=f+1),"default"!=DAMost.useCoupon&&DAMost.discoutAmount<i&&b._inArray(stage,data[f].plans)&&(DAMost.discoutAmount=i,DAMost.couponOrder=f+1),c=c.replace("{$couponInfo}",data[f].couponInfo),c=c.replace("{$activityId}",g),c=c.replace("{$activityId}",g),c=c.replace("{$couponDesc}",data[f].couponDesc),c=c.replace("{$startData}",data[f].startTime),c=c.replace("{$deadline}",data[f].finishTime),c=c.replace("{$data-plans}",data[f].plans),c=c.replace("{$discountAmount}",data[f].discount),c=c.replace("{$data-activityType}",data.activityType),5!=data[f].plans.length?(d=data[f].couponInfo+"(限分"+data[f].plans.join("/")+"期使用)",d=d.replace("限分1/",a.interestFreeDays+"、分")):d=data[f].couponInfo,c=c.replace("{$couponInfo}",d),list.push(c)}if(list&&b._couponWapper.find(".available-coupon").append(list.join("")),DAMost.couponOrder>0){var j=data[DAMost.couponOrder-1];DAMost.useCoupon="match",e={useCoupon:!0,couponNum:j.couponNum,activityId:j.activityId,couponInfo:j.couponInfo,couponDesc:j.couponDesc,plans:j.plans,stage:stage,serviceFee:"",total:"",repayment:"",discountAmount:"",shouldPay:"",isValid:0}}"0"==DAMost.useCoupon&&(e={useCoupon:"0",couponNum:"",activityId:"",couponInfo:"不使用优惠券",couponDesc:"",plans:"1,3,6,12,24",stage:stage,serviceFee:"",discountAmount:"",total:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,repayment:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,shouldPay:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,isValid:0}),b._couponWapper.find(".canUse-coupon-list-item .selectCoupon-list-item-link").eq(DAMost.couponOrder).addClass("checked")}else b._couponWapper.find(".available-coupon").addClass("no-coupons"),b._couponWapper.find(".available-coupon").html('<li><span class="no-coupons-info">您还没有可用的优惠券</span></li>'),e={useCoupon:0,couponNum:"",activityId:"",couponInfo:"暂无可用优惠",couponDesc:"",plans:"1,3,6,12,24",stage:stage,serviceFee:"",total:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,repayment:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,shouldPay:a.baitiaoOrderPrice?a.baitiaoOrderPrice:0,isValid:0};(1!=stage||0!=DAMost.useCoupon)&&(Ariel.Components.Loading.show(),b.updataStageLayer(e)),b.onInitCouponLayer.call(b,e),b._firstStageTemplate=b._firstStageTemplate.replace("{$interestFreeDays}",a.interestFreeDays),b._firstStageTemplate=b._firstStageTemplate.replace("{$interestFreeDays}",a.interestFreeDays)},_initUnavailableCouponList:function(a){var b,c=this,d=a.length,e=[];if(d>0){for(var f=0;d>f;f++)b=c._couponGreyItemListTemplate,b=b.replace("{$couponNum}",a[f].couponNum),b=b.replace("{$data-plans}",a[f].plans),b=b.replace("{$couponInfo}",a[f].couponInfo),b=b.replace("{$couponInfo}",a[f].couponInfo),b=b.replace("{$couponDesc}",a[f].couponDesc),b=b.replace("{$startData}",a[f].startTime),b=b.replace("{$deadline}",a[f].finishTime),e.push(b);e&&(c._couponWapper.find(".unavailable-coupon").html(e.join("")),c._couponWapper.find(".selectCoupon-list-item-grey").eq(0).removeClass("COMM_TOP_1PX_BORDER"))}else c._couponWapper.find(".unavailable-coupon").html('<li><span class="no-coupons-info">您还没有不可用的优惠券</span></li>'),c._couponWapper.find(".unavailable-coupon").addClass("no-coupons")},_initEvent:function(){var a=this;a._wrapper.delegate(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE.canChooseStage","click",function(){var b=$(this),c={stage:b.attr("data-stage"),serviceFee:b.attr("data-service-fee"),total:b.attr("data-total"),repayment:b.attr("data-repayment"),shouldPay:b.attr("data-should-pay"),discountAmount:b.attr("data-discountAmount"),isValid:0,repayDate:b.attr("data-firstRepayDate")};a._wrapper.find(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE").removeClass("checked"),$(".repayment-date").html("（还款日 "+c.repayDate+"）"),b.addClass("checked"),null==a.onSelectedStage?a.onUpdataStage.call(a,c):a.onSelectedStage.call(a,c),a.hideStageLayer()}),a._couponWapper.delegate(".selectCoupon-list-item.canUse-coupon-list-item","click",function(){var c=$(this).find(".selectCoupon-list-item-link");if(c.hasClass("checked"))return void a.hideCouponLayer();var d=a.getCouponData(c);b.Components.Loading.show(),a.updataStageLayer(d,c)}),a._wrapper.delegate(".select-panel-close","click",function(){$(".COMM_BLANK_NOTE_STAGE_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide()}),a._couponWapper.delegate(".select-panel-close","click",function(){$(".COMM_BLANK_NOTE_COUPON_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide()}),a._couponWapper.delegate(".selectCoupon-type-link","click",function(){var b=$(this),c=$(this).attr("data-couponList");a._couponWapper.find($(".selectCoupon-type-link")).find(".coupon-link-words").removeClass("coupon-link-onShow"),b.find(".coupon-link-words").addClass("coupon-link-onShow"),"available-coupon"==c&&($(".available-coupon").show(),$(".unavailable-coupon").hide()),"unavailable-coupon"==c&&($(".available-coupon").hide(),$(".unavailable-coupon").show())}),a._viewport.delegate(".COMM_BLANK_NOTE_LAYER_MASK","click",function(){$(".COMM_BLANK_NOTE_COUPON_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_STAGE_LAYER").removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide()})},updataStageLayer:function(a,c,d){var e=this,f={};f={couponCode:a.couponNum?a.couponNum:"",activityId:a.activityId?a.activityId:"",plans:$.isArray(a.plans)?a.plans.join(","):a.plans},0==$(".COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM").length&&e._viewport.append(e._wrapper),Common.Net.ajax({url:"calculateRate.action",type:"POST",data:f,success:function(g){0==g.code?(c&&e._switchCouponTo(a,c),e._updataBlankNoteStageList(g.payBillList),d&&e.showStageLayer()):Common.Net.ajax({url:"calculateRate.action",type:"POST",data:f,success:function(f){0==f.code?(c&&e._switchCouponTo(a,c),d&&e.showStageLayer(),e._updataBlankNoteStageList(f.payBillList)):(0==$(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE.checked").length&&e.intSeletBars(),b.Components.Pop.show(f.info?f.info:"获取白条信息失败，请重试"),Ariel.Components.Loading.hide())}})}})},showStageLayer:function(){var a=this;0==$(".COMM_BLANK_NOTE_STAGE_LAYER").length&&a._viewport.append(a._wrapper);var b=setTimeout(function(){0==$(".COMM_BLANK_NOTE_LAYER_MASK").length&&a._viewport.append(a._mask);var c=$(".COMM_BLANK_NOTE_STAGE_LAYER");Ariel.Components.Loading.hide(),c.addClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").show(),clearTimeout(b)},320)},hideStageLayer:function(){var a=$(".COMM_BLANK_NOTE_STAGE_LAYER"),b=setTimeout(function(){a.removeClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").hide(),clearTimeout(b)},500)},showCouponLayer:function(){var a=this;0==$(".COMM_BLANK_NOTE_LAYER_MASK").length&&a._viewport.append(a._mask),0==$(".COMM_BLANK_NOTE_COUPON_LAYER").length&&a._viewport.append(a._couponWapper);setTimeout(function(){Ariel.Components.Loading.hide();var a=$(".COMM_BLANK_NOTE_COUPON_LAYER");a.addClass("COM_LAYER_IN"),$(".COMM_BLANK_NOTE_LAYER_MASK").show(),clearTimeout(couponTD)},320)},hideCouponLayer:function(a){var b=$(".COMM_BLANK_NOTE_COUPON_LAYER"),c=this,d=setTimeout(function(){b.removeClass("COM_LAYER_IN"),a?c.showStageLayer():$(".COMM_BLANK_NOTE_LAYER_MASK").hide(),clearTimeout(d)},500)},_inArray:function(a,b){var c=b,d=parseInt(a);$.isArray(b)||(c=c.replace("[",""),c=c.replace("]",""),c=c.split(","));for(var e=0;e<c.length;e++)if(parseInt(c[e])==d)return!0;return!1},_matchCoupon:function(a,b){var c;return c=a.couponNum.indexOf("nothing")<0?a.couponNum.length>0&&a.couponNum==b.couponNum?!0:!1:b.activityId.length>0&&a.activityId==b.activityId?!0:!1},_switchCouponTo:function(a,b){var c=this,d=!0;c._inArray($(".choose-stage-bar").attr("data-stage"),a.plans)&&(d=!1),c._couponWapper.find(".selectCoupon-list-item-link").removeClass("checked"),b.addClass("checked"),c.onSelectedCoupon.call(c,a),c.hideCouponLayer(d)},intSeletBars:function(){var a=this;a._couponWapper.find(".selectCoupon-list-item-link").removeClass("checked");var b=a._couponWapper.find(".selectCoupon-use-no-coupon"),c=a.getCouponData(b);b.addClass("checked"),a._wrapper.find(".COMM_BLANK_NOTE_STAGE_LAYER_BLANK_NOTE_TYPE").eq(0).addClass("checked"),a.onInitCouponLayer(c)},getCouponData:function(a){var b={couponNum:a.attr("data-couponNum"),activityId:a.attr("data-activityId"),couponInfo:a.attr("data-couponInfo"),couponDesc:a.attr("data-couponDesc"),plans:a.attr("data-plans"),activityType:a.attr("data-activityType")};return b}}),a.Common.Components.GlobalBlankNoteLayers=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){this._init(),this._initEvent()};b.override(c.prototype,{HELP_FOR_EXPIRE:"HELP_FOR_EXPIRE",HELP_FOR_SAFE_CODE:"HELP_FOR_SAFE_CODE",AUTHENTICATION:"AUTHENTICATION",AGAIN_BIND_CARD:"AGAIN_BIND_CARD",SHOW_ID_CARD_INFO:"SHOW_ID_CARD_INFO",SHOW_PHONE_INFO:"SHOW_PHONE_INFO",_maskTemplate:'<div class="COMM_DIALOG_MASK"></div>',_template:'<div class="COMM_DIALOG_WRAPPER">    <div class="COMM_DIALOG">        <span class="COMM_DIALOG_TITLE"></span>        <a href="javascript:void(0);" class="COMM_DIALOG_CLOSE"></a>        <p class="COMM_DIALOG_DESCRIPTION"></p>        <a href="javascript:void(0);" class="COMM_DIALOG_BTN">我知道了</a>    </div></div>',_mask:null,_wrapper:null,_viewport:null,_init:function(){var a=this;a._mask=$(a._maskTemplate),a._wrapper=$(a._template),a._viewport=$("#viewport")},_initEvent:function(){var a=this;a._wrapper.find(".COMM_DIALOG_BTN").click(function(){a.hide()})},show:function(a){var b=this;a==b.HELP_FOR_EXPIRE&&(b._wrapper.find(".COMM_DIALOG_TITLE").text("卡片有效期"),b._wrapper.find(".COMM_DIALOG_DESCRIPTION").html("有效期为卡片正面格式为</br>月份/年份的数字").removeClass("COMM_DIALOG_SAFE_CODE_DESCRIPTION").addClass("COMM_DIALOG_EXPIRE_DESCRIPTION"),b._wrapper.removeClass("COMM_DIALOG_AUTHENTICATION COMM_AGAIN_BIND_CARD")),a==b.HELP_FOR_SAFE_CODE&&(b._wrapper.find(".COMM_DIALOG_TITLE").text("卡片安全码"),b._wrapper.find(".COMM_DIALOG_DESCRIPTION").html("安全码为卡背面签名处</br>一串数字的末三位").removeClass("COMM_DIALOG_EXPIRE_DESCRIPTION").addClass("COMM_DIALOG_SAFE_CODE_DESCRIPTION"),b._wrapper.removeClass("COMM_DIALOG_AUTHENTICATION COMM_AGAIN_BIND_CARD")),a==b.AUTHENTICATION&&(b._wrapper.find(".COMM_DIALOG_TITLE").text("购买全球购商品需验证您的身份信息"),b._wrapper.find(".COMM_DIALOG_DESCRIPTION").html('<div class="type-info-box"><p class="username"><label>姓&emsp;名</label><input id="holderName" type="text" placeholder="请输入姓名"></p><p class="authentication-num"><label>身份证</label><input id="holderId" type="text" placeholder="请输入身份证号"></p></div><p class="COMM_DIALOG_TIP">请填写正确的个人身份信息并授权我们向外汇管理局和海关申报，我们承诺妥善保管及使用您的信息。</p><div class="btn-wraps"><button class="confirm-auther-btn">确定</button></div>').removeClass("COMM_DIALOG_SAFE_CODE_DESCRIPTION"),b._wrapper.addClass("COMM_DIALOG_AUTHENTICATION")),a==b.AGAIN_BIND_CARD&&(b._wrapper.find(".COMM_DIALOG_TITLE").text("支付失败"),b._wrapper.find(".COMM_DIALOG_DESCRIPTION").html('<div class="pop-failure"><dl><dt>以下两种情况需要您重新绑卡：</dt><dd>1. 信用卡有效期过期或更换了卡片 <br />2. 修改了银行预留手机号</dd></dl><div class="btns-box"><a class="btn-item btn-cancel" href="javascript:Common.Components.HelpDialog.hideRebindDialog();">取消</a><a class="btn-item btn-rebind" href="javascript:Common.Components.HelpDialog.rebindCard();" >重新绑定</a></div></div>').removeClass("COMM_DIALOG_SAFE_CODE_DESCRIPTION"),b._wrapper.addClass("COMM_AGAIN_BIND_CARD")),a==b.SHOW_ID_CARD_INFO&&(b._wrapper.find(".COMM_DIALOG_TITLE").text("卡片安全码"),b._wrapper.find(".COMM_DIALOG_DESCRIPTION").html("此身份证号仅用于京东支付信息<br/>验证，不由银行验证").removeClass("COMM_DIALOG_EXPIRE_DESCRIPTION").addClass("COMM_DIALOG_SAFE_CODE_DESCRIPTION"),b._wrapper.addClass("COMM_AGAIN_BIND_CARD")),b._viewport.append(b._mask),b._viewport.append(b._wrapper)},hide:function(){var a=this;a._wrapper.remove(),a._mask.remove()},hideRebindDialog:function(){var a=this;Ariel.mpingEvent("JDCashierFastPay_Cancel",location.href),a.hide()},rebindCard:function(){Ariel.mpingEvent("JDCashierFastPay_Rebind",location.href),setTimeout(function(){a.location.href="/pay/new-card.html"},200)}}),a.Common.Components.HelpDialog=new c}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel;a.Common.Components.SwitchTextfile=b.extend(b.Components.Textfile,{_initEvent:function(){var a=this;a._fixedIOS7Focus(),a._wrapper.find(".textfile-input").unbind("blur").bind("blur",function(){a._fixedIOS7Focus(),a._validate()}),a._wrapper.find(".switchtextfile-switch").unbind(a._tap?"tap":"click").bind(a._tap?"tap":"click",function(){Ariel.mpingEvent("JDCashierIousSecurityVerify_PlaintextSwitch",location.href),a._switch()})},_switch:function(){var a=this,b=a._wrapper.find(".switchtextfile-status"),c=a._wrapper.find(".textfile-input");b.hasClass("switchtextfile-status-password")?(b.removeClass("switchtextfile-status-password").addClass("switchtextfile-status-code"),c.attr("type","input")):(b.removeClass("switchtextfile-status-code").addClass("switchtextfile-status-password"),c.attr("type","password"))},refresh:function(){var a=this;0!=a._wrapper.find(".textfile-input").val().length&&a._validate()}})}(window),function(a){a.Common||(a.Common={}),a.Common.Components||(a.Common.Components={});var b=a.Ariel,c=function(){this._init(),this._initEvent()};b.override(c.prototype,{_maskTemplate:'<div class="COMM_DIALOG_MASK"></div>',_template:'<div class="COMM_DIALOG_WRAPPER">    <div class="SHOW_INFO_DIALOG">        <span class="COMM_DIALOG_TITLE"></span>        <p class="COMM_DIALOG_DESCRIPTION SHOW_INFO"></p>        <a href="javascript:void(0);" class="COMM_DIALOG_BTN">我知道了</a>    </div></div>',_mask:null,_wrapper:null,_viewport:null,_init:function(){var a=this;a._mask=$(a._maskTemplate),a._wrapper=$(a._template),a._viewport=$("#viewport")},_initEvent:function(){var a=this;a._wrapper.find(".COMM_DIALOG_BTN").click(function(){a.hide()})},show:function(a){var b=this;b._wrapper.find(".COMM_DIALOG_DESCRIPTION").html(a),b._viewport.append(b._mask),b._viewport.append(b._wrapper)},hide:function(){var a=this;a._wrapper.remove(),a._mask.remove()}}),a.Common.Components.CommonDialog=new c}(window),function(a){function b(a){var b=e,c=b.biDivideByRadixPower(a,this.k-1),d=b.biMultiply(c,this.mu),f=b.biDivideByRadixPower(d,this.k+1),g=b.biModuloByRadixPower(a,this.k+1),h=b.biMultiply(f,this.modulus),i=b.biModuloByRadixPower(h,this.k+1),j=b.biSubtract(g,i);j.isNeg&&(j=b.biAdd(j,this.bkplus1));for(var k=b.biCompare(j,this.modulus)>=0;k;)j=b.biSubtract(j,this.modulus),k=b.biCompare(j,this.modulus)>=0;return j}function c(a,b){var c=e.biMultiply(a,b);return this.modulo(c)}function d(a,b){var c=new r;c.digits[0]=1;for(var d=a,f=b;;){if(0!=(1&f.digits[0])&&(c=this.multiplyMod(c,d)),f=e.biShiftRight(f,1),0==f.digits[0]&&0==e.biHighIndex(f))break;d=this.multiplyMod(d,d)}return c}if("undefined"==typeof a.RSAUtils)var e=a.RSAUtils={};var f,g,h,k,l=16,m=l,n=65536,o=n>>>1,p=n*n,q=n-1,r=a.BigInt=function(a){"boolean"==typeof a&&1==a?this.digits=null:this.digits=g.slice(0),this.isNeg=!1};e.setMaxDigits=function(a){f=a,g=new Array(f);for(var b=0;b<g.length;b++)g[b]=0;h=new r,k=new r,k.digits[0]=1},e.setMaxDigits(20);var s=15;e.biFromNumber=function(a){var b=new r;b.isNeg=0>a,a=Math.abs(a);for(var c=0;a>0;)b.digits[c++]=a&q,a=Math.floor(a/n);return b};var t=e.biFromNumber(1e15);e.biFromDecimal=function(a){for(var b,c="-"==a.charAt(0),d=c?1:0;d<a.length&&"0"==a.charAt(d);)++d;if(d==a.length)b=new r;else{var f=a.length-d,g=f%s;for(0==g&&(g=s),b=e.biFromNumber(Number(a.substr(d,g))),d+=g;d<a.length;)b=e.biAdd(e.biMultiply(b,t),e.biFromNumber(Number(a.substr(d,s)))),d+=s;b.isNeg=c}return b},e.biCopy=function(a){var b=new r(!0);return b.digits=a.digits.slice(0),b.isNeg=a.isNeg,b},e.reverseStr=function(a){for(var b="",c=a.length-1;c>-1;--c)b+=a.charAt(c);return b};var u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];e.biToString=function(a,b){var c=new r;c.digits[0]=b;for(var d=e.biDivideModulo(a,c),f=u[d[1].digits[0]];1==e.biCompare(d[0],h);)d=e.biDivideModulo(d[0],c),digit=d[1].digits[0],f+=u[d[1].digits[0]];return(a.isNeg?"-":"")+e.reverseStr(f)},e.biToDecimal=function(a){var b=new r;b.digits[0]=10;for(var c=e.biDivideModulo(a,b),d=String(c[1].digits[0]);1==e.biCompare(c[0],h);)c=e.biDivideModulo(c[0],b),d+=String(c[1].digits[0]);return(a.isNeg?"-":"")+e.reverseStr(d)};var v=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];e.digitToHex=function(a){var b=15,c="";for(i=0;i<4;++i)c+=v[a&b],a>>>=4;return e.reverseStr(c)},e.biToHex=function(a){for(var b="",c=(e.biHighIndex(a),e.biHighIndex(a));c>-1;--c)b+=e.digitToHex(a.digits[c]);return b},e.charToHex=function(a){var b,c=48,d=c+9,e=97,f=e+25,g=65,h=90;return b=a>=c&&d>=a?a-c:a>=g&&h>=a?10+a-g:a>=e&&f>=a?10+a-e:0},e.hexToDigit=function(a){for(var b=0,c=Math.min(a.length,4),d=0;c>d;++d)b<<=4,b|=e.charToHex(a.charCodeAt(d));return b},e.biFromHex=function(a){for(var b=new r,c=a.length,d=c,f=0;d>0;d-=4,++f)b.digits[f]=e.hexToDigit(a.substr(Math.max(d-4,0),Math.min(d,4)));return b},e.biFromString=function(a,b){var c="-"==a.charAt(0),d=c?1:0,f=new r,g=new r;g.digits[0]=1;for(var h=a.length-1;h>=d;h--){var i=a.charCodeAt(h),j=e.charToHex(i),k=e.biMultiplyDigit(g,j);f=e.biAdd(f,k),g=e.biMultiplyDigit(g,b)}return f.isNeg=c,f},e.biDump=function(a){return(a.isNeg?"-":"")+a.digits.join(" ")},e.biAdd=function(a,b){var c;if(a.isNeg!=b.isNeg)b.isNeg=!b.isNeg,c=e.biSubtract(a,b),b.isNeg=!b.isNeg;else{c=new r;for(var d,f=0,g=0;g<a.digits.length;++g)d=a.digits[g]+b.digits[g]+f,c.digits[g]=d%n,f=Number(d>=n);c.isNeg=a.isNeg}return c},e.biSubtract=function(a,b){var c;if(a.isNeg!=b.isNeg)b.isNeg=!b.isNeg,c=e.biAdd(a,b),b.isNeg=!b.isNeg;else{c=new r;var d,f;f=0;for(var g=0;g<a.digits.length;++g)d=a.digits[g]-b.digits[g]+f,c.digits[g]=d%n,c.digits[g]<0&&(c.digits[g]+=n),f=0-Number(0>d);if(-1==f){f=0;for(var g=0;g<a.digits.length;++g)d=0-c.digits[g]+f,c.digits[g]=d%n,c.digits[g]<0&&(c.digits[g]+=n),f=0-Number(0>d);c.isNeg=!a.isNeg}else c.isNeg=a.isNeg}return c},e.biHighIndex=function(a){for(var b=a.digits.length-1;b>0&&0==a.digits[b];)--b;return b},e.biNumBits=function(a){var b,c=e.biHighIndex(a),d=a.digits[c],f=(c+1)*m;for(b=f;b>f-m&&0==(32768&d);--b)d<<=1;return b},e.biMultiply=function(a,b){for(var c,d,f,g=new r,h=e.biHighIndex(a),i=e.biHighIndex(b),k=0;i>=k;++k){for(c=0,f=k,j=0;j<=h;++j,++f)d=g.digits[f]+a.digits[j]*b.digits[k]+c,g.digits[f]=d&q,c=d>>>l;g.digits[k+h+1]=c}return g.isNeg=a.isNeg!=b.isNeg,g},e.biMultiplyDigit=function(a,b){var c,d,f;result=new r,c=e.biHighIndex(a),d=0;for(var g=0;c>=g;++g)f=result.digits[g]+a.digits[g]*b+d,result.digits[g]=f&q,d=f>>>l;return result.digits[1+c]=d,result},e.arrayCopy=function(a,b,c,d,e){for(var f=Math.min(b+e,a.length),g=b,h=d;f>g;++g,++h)c[h]=a[g]};var w=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];e.biShiftLeft=function(a,b){var c=Math.floor(b/m),d=new r;e.arrayCopy(a.digits,0,d.digits,c,d.digits.length-c);for(var f=b%m,g=m-f,h=d.digits.length-1,i=h-1;h>0;--h,--i)d.digits[h]=d.digits[h]<<f&q|(d.digits[i]&w[f])>>>g;return d.digits[0]=d.digits[h]<<f&q,d.isNeg=a.isNeg,d};var x=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.biShiftRight=function(a,b){var c=Math.floor(b/m),d=new r;e.arrayCopy(a.digits,c,d.digits,0,a.digits.length-c);for(var f=b%m,g=m-f,h=0,i=h+1;h<d.digits.length-1;++h,++i)d.digits[h]=d.digits[h]>>>f|(d.digits[i]&x[f])<<g;return d.digits[d.digits.length-1]>>>=f,d.isNeg=a.isNeg,d},e.biMultiplyByRadixPower=function(a,b){var c=new r;return e.arrayCopy(a.digits,0,c.digits,b,c.digits.length-b),c},e.biDivideByRadixPower=function(a,b){
var c=new r;return e.arrayCopy(a.digits,b,c.digits,0,c.digits.length-b),c},e.biModuloByRadixPower=function(a,b){var c=new r;return e.arrayCopy(a.digits,0,c.digits,0,b),c},e.biCompare=function(a,b){if(a.isNeg!=b.isNeg)return 1-2*Number(a.isNeg);for(var c=a.digits.length-1;c>=0;--c)if(a.digits[c]!=b.digits[c])return a.isNeg?1-2*Number(a.digits[c]>b.digits[c]):1-2*Number(a.digits[c]<b.digits[c]);return 0},e.biDivideModulo=function(a,b){var c,d,f=e.biNumBits(a),g=e.biNumBits(b),h=b.isNeg;if(g>f)return a.isNeg?(c=e.biCopy(k),c.isNeg=!b.isNeg,a.isNeg=!1,b.isNeg=!1,d=biSubtract(b,a),a.isNeg=!0,b.isNeg=h):(c=new r,d=e.biCopy(a)),[c,d];c=new r,d=a;for(var i=Math.ceil(g/m)-1,j=0;b.digits[i]<o;)b=e.biShiftLeft(b,1),++j,++g,i=Math.ceil(g/m)-1;d=e.biShiftLeft(d,j),f+=j;for(var l=Math.ceil(f/m)-1,s=e.biMultiplyByRadixPower(b,l-i);-1!=e.biCompare(d,s);)++c.digits[l-i],d=e.biSubtract(d,s);for(var t=l;t>i;--t){var u=t>=d.digits.length?0:d.digits[t],v=t-1>=d.digits.length?0:d.digits[t-1],w=t-2>=d.digits.length?0:d.digits[t-2],x=i>=b.digits.length?0:b.digits[i],y=i-1>=b.digits.length?0:b.digits[i-1];u==x?c.digits[t-i-1]=q:c.digits[t-i-1]=Math.floor((u*n+v)/x);for(var z=c.digits[t-i-1]*(x*n+y),A=u*p+(v*n+w);z>A;)--c.digits[t-i-1],z=c.digits[t-i-1]*(x*n|y),A=u*n*n+(v*n+w);s=e.biMultiplyByRadixPower(b,t-i-1),d=e.biSubtract(d,e.biMultiplyDigit(s,c.digits[t-i-1])),d.isNeg&&(d=e.biAdd(d,s),--c.digits[t-i-1])}return d=e.biShiftRight(d,j),c.isNeg=a.isNeg!=h,a.isNeg&&(c=h?e.biAdd(c,k):e.biSubtract(c,k),b=e.biShiftRight(b,j),d=e.biSubtract(b,d)),0==d.digits[0]&&0==e.biHighIndex(d)&&(d.isNeg=!1),[c,d]},e.biDivide=function(a,b){return e.biDivideModulo(a,b)[0]},e.biModulo=function(a,b){return e.biDivideModulo(a,b)[1]},e.biMultiplyMod=function(a,b,c){return e.biModulo(e.biMultiply(a,b),c)},e.biPow=function(a,b){for(var c=k,d=a;;){if(0!=(1&b)&&(c=e.biMultiply(c,d)),b>>=1,0==b)break;d=e.biMultiply(d,d)}return c},e.biPowMod=function(a,b,c){for(var d=k,f=a,g=b;;){if(0!=(1&g.digits[0])&&(d=e.biMultiplyMod(d,f,c)),g=e.biShiftRight(g,1),0==g.digits[0]&&0==e.biHighIndex(g))break;f=e.biMultiplyMod(f,f,c)}return d},a.BarrettMu=function(a){this.modulus=e.biCopy(a),this.k=e.biHighIndex(this.modulus)+1;var f=new r;f.digits[2*this.k]=1,this.mu=e.biDivide(f,this.modulus),this.bkplus1=new r,this.bkplus1.digits[this.k+1]=1,this.modulo=b,this.multiplyMod=c,this.powMod=d};var y=function(b,c,d){var f=e;this.e=f.biFromHex(b),this.d=f.biFromHex(c),this.m=f.biFromHex(d),this.chunkSize=2*f.biHighIndex(this.m),this.radix=16,this.barrett=new a.BarrettMu(this.m)};e.getKeyPair=function(a,b,c){return new y(a,b,c)},"undefined"==typeof a.twoDigit&&(a.twoDigit=function(a){return(10>a?"0":"")+String(a)}),e.encryptedString=function(a,b){for(var c=[],d=b.length,f=0;d>f;)c[f]=b.charCodeAt(f),f++;for(;c.length%a.chunkSize!=0;)c[f++]=0;var g,h,i,j=c.length,k="";for(f=0;j>f;f+=a.chunkSize){for(i=new r,g=0,h=f;h<f+a.chunkSize;++g)i.digits[g]=c[h++],i.digits[g]+=c[h++]<<8;var l=a.barrett.powMod(i,a.e),m=16==a.radix?e.biToHex(l):e.biToString(l,a.radix);k+=m+" "}return k.substring(0,k.length-1)},e.decryptedString=function(a,b){var c,d,f,g=b.split(" "),h="";for(c=0;c<g.length;++c){var i;for(i=16==a.radix?e.biFromHex(g[c]):e.biFromString(g[c],a.radix),f=a.barrett.powMod(i,a.d),d=0;d<=e.biHighIndex(f);++d)h+=String.fromCharCode(255&f.digits[d],f.digits[d]>>8)}return 0==h.charCodeAt(h.length-1)&&(h=h.substring(0,h.length-1)),h},e.setMaxDigits(130)}(window);var publicKey={};publicKey.mu="9f274d9e2d73d3c4df83d4e58cd6c9e57aead58463fdec0cf3734ecef398ebc1773019d9ae4a93c0a8cbed066e3021b8495ca6a8d5d9f57a676b37920f431ebc998c646cf013bd62ed53e8e099eb8582ea7bb1ef1ef7edb89ecc99c96ea2e5323c78fdd9256216bdfbfe58f4f13ae9c224bf7c4e6a17893b45a970693ccd5f0b",publicKey.po="10001",Page=function(){var a=this;a.init(),a.initEvent()},Page.prototype.init=function(){var a=this;Ariel.mpingPV(),a._displayHeader(),a._noNeedScroller!==!0&&(a._pageScroller=new IScroll($(".JS-page-ct").get(0),{tap:!0}))},Page.prototype.initEvent=function(){window.navigator.userAgent;$(".JS-page-ct").bind("tap",function(a){var b=a.target,c=b.tagName;"INPUT"!=c&&"A"==c&&$(b).focus()})},Page.prototype._showHeader=function(){try{var a=new MCommonHeaderBottom,b=$("title")[0].innerText,c={hrederId:"m_common_header",title:b,isShowShortCut:!1,selectedShortCut:"4",onClickJdkey:function(){"none"==$("#m_common_header_shortcut").css("display")?($(".page-ct").addClass("page-ct-m-show-header"),$(".order-bar-wrap").addClass("order-bar-wrap-m-show-header")):($(".page-ct").removeClass("page-ct-m-show-header"),$(".order-bar-wrap").removeClass("order-bar-wrap-m-show-header"))},onClickGoback:function(){},onClickIndex:function(){},onClickSearch:function(){},onClickCart:function(){},onClickHome:function(){}};a.header(c),setTimeout(function(){try{var a="m_common_header_goback",b=location.pathname;if(b.indexOf("index.html")>=0){if(!document.getElementById(a))return;var c=$("#"+a).clone().wrap("<div>").parent().html(),d=document.getElementById(a).parentNode;$("#"+a).remove();var e=$(c);d.insertBefore(e[0],d.firstChild),$("#"+a).bind("click",function(){var a="下单后24小时内未支付成功，订单将被取消，请尽快完成支付",b=closeIndexPage();b&&(a=b),Common.Components.GoBackMsgBox.show(a)})}}catch(f){}},1e3)}catch(d){$(".page-ct").removeClass("page-ct-m-show-header"),$(".order-bar-wrap").removeClass("order-bar-wrap-m-show-header"),$("#m_common_header").hide(),$(".order-bar-wrap").removeClass("order-bar-wrap-m"),$(".page-ct").removeClass("page-ct-m")}},Page.prototype._displayHeader=function(a){function b(a){for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++)if(b[c].src==a)return!0;return!1}var c,d,e=this;if(a)c=a;else{if(d=Common.JSON.parse(Ariel.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_BUSINESS_DATA)),!d)return;c=Number(d.isDisplayHeader)}if(c){var f=document.createElement("script");f.type="text/javascript",f.src="https://st.360buyimg.com/common/commonH_B/js/m_common_header_bottom2.1.js",f.onload=f.onreadystatechange=function(){this.readyState&&"loading"==this.readyState||(e._showHeader(),$("#m_common_header").show(),$(".order-bar-wrap").addClass("order-bar-wrap-m"),$(".page-ct").addClass("page-ct-m"))},f.onerror=function(){h.removeChild(f)};var g=document.createElement("script");if(g.type="text/javascript",g.src="https://st.360buyimg.com/common/commonH_B/js/m_common2.1.js",!b(g.src)){var h=document.getElementsByTagName("head")[0];h.appendChild(g)}if(!b(f.src)){var h=document.getElementsByTagName("head")[0];h.appendChild(f)}}else $("#m_common_header").hide(),$(".order-bar-wrap").removeClass("order-bar-wrap-m"),$(".page-ct").removeClass("page-ct-m");if("none"!=$(".home-notice-wrap").css("display")){var i=$(".position-change"),j=parseInt(i.css("top"))+34;i.css("top",j+"px")}},Page.prototype._sendMonitorData=function(){try{var a={error:"34","blank-note":"35",coffer:"36","quick-pay":"37","verify-code":"38","new-card":"39","new-card-info":"40","quick-pay-open":"42",finish:"33","binded-list":"","unbind-card":"","other-pay-info":"81","other-pay":"82","other-pay-success":"83","global-blank-note":"84"},b={index:"24"},c=window.location.pathname.split("/"),d=c[c.length-1].split(".")[0],e="";b[d]?(e=b[d],rTimeArr[5]={time:new Date,sTime:"4"},rTimeArr[6]={time:new Date,sTime:"0"}):(e=a[d],rTimeArr[5]={time:new Date,sTime:"0"});var f=new R_Time,g=f.calculateTime(rTimeArr),h=f.urlParse("sid")||"",i=f.extend({flag:"2",id:e,sid:h},g);f.sendTime(i)}catch(j){}};