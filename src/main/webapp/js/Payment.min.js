Payment=function(a){var b=this;$.each(a,function(a,c){b[a]=c}),b._init(),b._initEvent()},Ariel.override(Payment.prototype,{_wrapper:null,_template:'<li class="list-item list-link-item pay-list-item other-pay-list-item"><a href="javascript:void(0);" class="list-link"><span class="pay-icon"></span><span class="title-main">----</span><span class="discount-amount">--</span><span class="available-money">--</span><span class="title-vice">---------</span></a></li>',_defaultTemplate:null,_otherWrapper:".other-pay-list",_defaultWrapper:".default-pay-list",_isDefaultPayment:!1,_titleMain:null,_titleVice:null,_discountAmount:null,_baitiaoOrderPrice:null,_availableMoney:null,_specialCss:null,_payType:null,_status:0,_data:null,_client:null,_pageScroller:null,_total:null,_tip:null,_init:function(){this._isDefaultPayment&&this._defaultTemplate?this._wrapper=$(this._defaultTemplate):this._wrapper=$(this._template),this._initDescription(),"3"==this._status&&this._wrapper.addClass("disabled-pay-list-item").attr("data-pop",this._tip?this._tip:"此支付方式不可用")},_initEvent:function(){var a=this;this._isDefaultPayment?a.initDefaultPaymentEvent():this._wrapper.find(".list-link").bind("tap",function(b){return $(a._wrapper).hasClass("disabled-pay-list-item")?void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop")):(b.stopPropagation(),a._initCrossData(),void a.startPayAction.call(a))})},_initCrossData:function(){if(Ariel.Courier._canStorage()){var a=this,b={};for(var c in a){var d=a[c];!d||"string"!=typeof d&&"number"!=typeof d||(b[c]=d)}b._data=a._data,Ariel.Courier.add(Common.DataKeys.ACROSS_PAGES_PAYMENT_DATA,JSON.stringify(b))}},_initDescription:function(){this._wrapper.find(".title-main").html(this._titleMain),this._titleVice?this._wrapper.find(".title-vice").html(this._titleVice):this._wrapper.find(".title-vice").remove(),this._discountAmount?this._wrapper.find(".discount-amount").html(this._discountAmount):this._wrapper.find(".discount-amount").remove(),this._availableMoney?this._wrapper.find(".available-money").html(this._availableMoney):this._wrapper.find(".available-money").remove(),this._specialCss&&this._wrapper.addClass(this._specialCss),!this._isDefaultPayment&&this._data&&this._data.baiTiaoCounponText&&0!=this._data.baiTiaoCounponText.length&&(this._wrapper.find(".title-main").append('<span class="coupons-number">'+this._data.baiTiaoCounponText+"</span>"),this._wrapper.find(".coupons-number").show()),this.setDefaultDescription()},setInitClass:function(a){this._wrapper.addClass(a)},setTitleVice:function(a){this._wrapper.find(".title-vice").html(a)},getTitleVice:function(a){return this._wrapper.find(".title-vice").val()},setDiscountAmount:function(a){this._wrapper.find(".discount-amount").html(a)},getDiscountAmount:function(a){return this._wrapper.find(".discount-amount").val()},setAvailableMoney:function(a){this._wrapper.find(".available-money").html(a)},getAvailableMoney:function(a){return this._wrapper.find(".available-money").val()},startPayAction:function(){},initDefaultPaymentEvent:function(){var a=this;this._wrapper.find(".list-link").bind("tap",function(){return $(a._wrapper).hasClass("disabled-pay-list-item")?void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop")):(a._initCrossData(),void a.startPayAction.call(a))})},setDefaultDescription:function(){},disablePayment:function(a){this._wrapper.addClass("disabled-pay-list-item"),this._wrapper.attr("data-pop",a)},render:function(){this._isDefaultPayment?($(this._defaultWrapper).append(this._wrapper),$(this._defaultWrapper).show()):($(this._otherWrapper).append(this._wrapper),$(this._otherWrapper).show()),this._wrapper.show()}}),WeixinPayment=Ariel.extend(Payment,{_specialCss:"weixin-pay",_payType:"weixin",startPayAction:function(){var a=this,b=a._client,c=Ariel.parseGetParameters(),d=c.payId;switch(b){case"android":case"apple":window.location.href='openApp.jdMobile://communication?params={"type":"10","payId":"'+d+'"}';break;case"wp":window.external.Notify('openApp.jdMobile://communication?params={"type":"10","payId":"'+d+'"}');break;case"iPad":window.location.href='openApp.jdMobile://communication?params={"type":"10","payId":"'+d+'"}'}}}),WeixinWapPayment=Ariel.extend(Payment,{_specialCss:"weixin-pay",_payType:"wapWeixinPay",startPayAction:function(){var a=this,b=Ariel.parseGetParameters();Ariel.Components.Loading.show(),Common.Net.ajax({url:"../index.action",skipProcessUrl:!0,data:{functionId:"wapWeiXinPay",body:JSON.stringify(b)},success:function(b){"0"==b.code&&b.deepLink&&""!=b.deepLink?(b._total=a._total,Common.Components.WapPayMsgBox._setFinishData(b),a._callWeixinPay(b),setTimeout(function(){Ariel.Components.Loading.hide(),Common.Components.WapPayMsgBox.show()},5e3)):(Ariel.Components.Loading.hide(),Ariel.Components.Pop.show(b.message?b.message:"微信支付失败！"))}})},_callWeixinPay:function(a){var b='<a href="javascript:void(0);"  class="weixin-wap-deeplink"></a>';if(a&&a.deepLink){var c=$(".weixin-wap-deeplink");(!c||c.length<=0)&&$("#viewport").append($(b)),$(".weixin-wap-deeplink").attr("href",a.deepLink),$(".weixin-wap-deeplink").click()}}}),WeixinInnerPayment=Ariel.extend(Payment,{_specialCss:"weixin-pay",_payType:"weiXinGzh",startPayAction:function(){var a=this,b=Ariel.parseGetParameters();a.is_weixin()?b.code?(Ariel.Components.Loading.show(),Common.Net.ajax({url:"weiXinGzhPay.action",data:{weiXinGzhCode:b.code},success:function(c){function d(){WeixinJSBridge.invoke("getBrandWCPayRequest",c.params,function(c){Ariel.Components.Loading.hide(),"get_brand_wcpay_request:ok"==c.err_msg&&window.Common.FinishPage.go(b,{_total:a._total})})}c&&"0"==c.code?"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",d,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",d),document.attachEvent("onWeixinJSBridgeReady",d)):d():(Ariel.Components.Loading.hide(),Ariel.Components.Pop.show(c.message?c.message:"支付失败，请重试！"))}})):Common.Net.ajax({url:"getXinGzhCodeUrl.action",data:{},success:function(a){a&&"0"==a.code?window.location.href=a.weiXinGzhshareUrl:Ariel.Components.Pop.show(a.message?a.message:"支付失败，请重试！")}}):Ariel.Components.Pop.show("只能在微信内支付！")},is_weixin:function(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)?!0:!1}}),WeixinOtherPayment=Ariel.extend(Payment,{_specialCss:"weixin-other-pay",_payType:"weixinOtherPay",_SHARE_IMAGE_URL:"/img/pay/share.png",_duplicate:null,startPayAction:function(){var a=this;if(null!=a._duplicate){var b=(new Date).valueOf()-a._duplicate;if(500>b)return void(a._duplicate=null)}else a._duplicate=(new Date).valueOf();var c=Ariel.parseGetParameters();Ariel.Components.Loading.show(),Common.Net.ajax({url:"isFirstWeiXinDaiFu.action",success:function(b){if(b&&0==b.code)if(1==b.isFirst){var d=Ariel.Courier.get(Common.DataKeys.ACROSS_PAGES_PAYMENT_DATA),e=Common.JSON.parse(d);for(var f in c)e[f]=c[f];e.data=b,Ariel.Components.Loading.hide(),setTimeout(function(){Ariel.Courier.add(Common.DataKeys.ACROSS_PAGES_PAYMENT_DATA,JSON.stringify(e)),b.isWishList&&1==b.isWishList?(Ariel.mpingEvent("MChristmasWish_Pay",location.href,0),setTimeout(function(){window.location.href="weixin-activity-info.html"},200)):(Ariel.mpingEvent("JDCashier_WeChatpayment",location.href,0),setTimeout(function(){window.location.href="other-pay-info.html"},200))},200)}else Ariel.mpingEvent("JDCashier_WeChatpayment",location.href,1),a._startShareToFriends(b),Ariel.Components.Loading.hide();else Ariel.Components.Loading.hide(),Ariel.Components.Pop.show(b.message?b.message:"微信代付失败！")}})},_startShareToFriends:function(a){var b=this,c=b._client,d=Ariel.parseGetParameters(),e=window.location.origin+"/pay/"+b._SHARE_IMAGE_URL;switch(window.jdappShareRes=function(a){a&&(0==a.shareResult?(Ariel.mpingEvent("JDCashierWeChatpayment_Sendrequest",location.href,1),"android"==c&&Ariel.Components.PopWithIcon.show("发送成功，请耐心等待朋友付款")):1==a.shareResult&&(Ariel.mpingEvent("JDCashierWeChatpayment_Sendrequest",location.href,0),"android"==c&&Ariel.Components.Pop.show("发送失败，请重试")))},c){case"android":"undefined"==typeof shareHelper?Ariel.Components.Pop.show("发送代付失败"):shareHelper.sendShare(a.title,a.description,a.shareUrl,e,"Wxfriends","Y");break;case"apple":case"iPad":var d={category:"jump",des:"share",type:"111",title:a.title,content:a.description,shareUrl:a.shareUrl,imageUrl:e,channel:"WeChat_Friend"};window.location.href="openApp.jdmobile://virtual?params="+encodeURIComponent(JSON.stringify(d))}}}),ApplePayment=Ariel.extend(Payment,{_specialCss:"apple-pay",_payType:"applePay",startPayAction:function(){var a=Ariel.parseGetParameters();window.location.href='openApp.jdMobile://communication?params={"type":"11","payId":"'+a.payId+'"}'},setDefaultDescription:function(){var a=this;this._wrapper.attr("bindingVice",a._data.bindingVice),this._wrapper.attr("bindingMain",a._data.bindingMain),this._wrapper.attr("unbindingVice",a._data.unbindingVice),this._wrapper.attr("unbindingMain",a._data.unbindingMain),this._wrapper.attr("binding",a._data.binding),"1"==a._data.binding?(a._data.bindingVice&&this._wrapper.find(".title-vice").html(a._data.bindingVice),a._data.bindingMain&&this._wrapper.find(".title-main").html(a._data.bindingMain)):"0"==a._data.binding&&(a._data.unbindingVice&&this._wrapper.find(".title-vice").html(a._data.unbindingVice),a._data.unbindingMain&&this._wrapper.find(".title-main").html(a._data.unbindingMain))}}),UnionPayment=Ariel.extend(Payment,{_specialCss:"union-pay",_payType:"cups",startPayAction:function(){var a=this,b=a._client,c=Ariel.parseGetParameters(),d=c.payId;switch(b){case"wp":window.external.Notify('openApp.jdMobile://communication?params={"type":"4","payId":"'+d+'"}');break;case"androidPad":window.location.href='openApp.jdaPad://communication?params={"type":"4","payId":"'+d+'"}';break;case"iPad":0==orderType?window.location.href='openApp.jdMobile://communication?params={"type":"4","payId":"'+d+'"}':window.location.href='openApp.jdaPad://communication?params={"type":"4","payId":"'+d+'"}';break;case"o2otjandroid":window.location.href='openApp.o2otjMobile://communication?params={"type":"4","payId":"'+d+'"}';break;default:window.location.href='openApp.jdMobile://communication?params={"type":"4","payId":"'+d+'"}'}}}),NetBankPayment=Ariel.extend(Payment,{_specialCss:"net-bank",_payType:"wangyin",startPayAction:function(){var a=this,b=a.client;Ariel.Components.Loading.show();var c=Ariel.parseGetParameters();Common.Net.ajax({url:"isJDpay2Valid.action",type:"POST",data:{},success:function(d){if(d&&d.success)if(d.isJDpay2Valid&&d.isApp&&"wp"!=b)switch(Ariel.Components.Loading.hide(),b){case"apple":case"iPad":case"android":window.location.href='openApp.jdMobile://communication?params={"type":"12","payId":"'+c.payId+'"}';break;default:window.location.href='openApp.jdMobile://communication?params={"type":"12","payId":"'+c.payId+'"}'}else{if(d.isJDpay2Valid&&!d.isApp&&d.cashierUrl)return void(window.location.href=d.cashierUrl);a._callHtml5pay(d)}else a._callHtml5pay(d)}})},_callHtml5pay:function(a){Common.Net.ajax({url:"wangyinPay.action",type:"POST",data:{},success:function(a){if(Ariel.Components.Loading.hide(),a.reqSignMap){var b='<form id="net-bank-form" action="'+a.reqSignMap.wangyinPayUrl+'" method="POST">    <input type="hidden" name="version" value="'+a.reqSignMap.version+'" />    <input type="hidden" name="token" value="'+a.reqSignMap.token+'" />    <input type="hidden" name="merchantSign" value="'+a.reqSignMap.merchantSign+'" />    <input type="hidden" name="merchantNum" value="'+a.reqSignMap.merchantNum+'" />    <input type="hidden" name="merchantRemark" value="'+a.reqSignMap.merchantRemark+'" />    <input type="hidden" name="tradeNum" value="'+a.reqSignMap.tradeNum+'" />    <input type="hidden" name="tradeName" value="'+a.reqSignMap.tradeName+'" />    <input type="hidden" name="tradeDescription" value="'+a.reqSignMap.tradeDescription+'" />    <input type="hidden" name="tradeTime" value="'+a.reqSignMap.tradeTime+'" />    <input type="hidden" name="tradeAmount" value="'+a.reqSignMap.tradeAmount+'" />    <input type="hidden" name="currency" value="'+a.reqSignMap.currency+'" />    <input type="hidden" name="notifyUrl" value="'+a.reqSignMap.notifyUrl+'" />    <input type="hidden" name="successCallbackUrl" value="'+a.reqSignMap.successCallbackUrl+'" />    <input type="hidden" name="failCallbackUrl" value="'+a.reqSignMap.failCallbackUrl+'" />    <input type="hidden" name="jdPin" value="'+a.reqSignMap.jdPin+'" />    <input type="hidden" name="merchantOrderNum" value="'+a.reqSignMap.merchantOrderNum+'" /></form>';$("#net-bank-form").remove(),$("#viewport").append($(b)),$("#net-bank-form").get(0).submit()}else Ariel.Components.Pop.show("支付异常，请重新选择支付方式支付")}})}}),QuickPayment=Ariel.extend(Payment,{_specialCss:"quick-pay",_payType:"quick",_cardType:null,_CREDIT:"CreditCard",_DEBIT:"DebitCard",_defaultTemplate:'<li class="list-item pay-list-item default-pay-list-item quick-pay"><div class="pay-base-info-wrap"><span class="pay-icon"></span><span class="title-main">--</span><span class="title-vice">--</span><a href="javascript:void(0);" class="card-info choose-quick-pay COMM_1PX_BORDER"><span class="default-bank">--</span></a></div><ul class="list safe-code-list"><li class="list-item"><span class="safe-code-title-main">安全码</span><div class="textfile card-textfile safe-code"><input type="tel" maxlength="3" class="textfile-input" placeholder="请输入卡背面末三位数字" /><a href="javascript:void(0);"  class="close-btn textfile-reset textfile-reset-hide"><span class="close-btn-cross"></span></a></div> <a href="javascript:void(0);" class="tip-icon card-tip safe-code-tip"></a></li></ul>  <div class="next-wrap"><a href="javascript:void(0);" class="btn b-btn next">立即支付</a><p class="pay-false-btn">支付失败？</p></div></li>',_currentBank:null,startPayAction:function(){var a=this;Ariel.Components.Loading.show(),Common.Net.ajax({url:"getBindingBankList.action",success:function(b){if(Ariel.Components.Loading.hide(),b&&b.success){var c={};if(b.bankListJson&&(c=Common.JSON.parse(b.bankListJson)),c.bindingList&&c.bindingList.length>0){a._data=[];for(var d=c.bindingList,e=0;e<d.length;e++)a._data[e]={agencyCode:d[e].agencyCode,bankName:d[e].bankName,acronym:d[e].bankNo,cardId:d[e].cardId,last4Bit:d[e].cardNoShort,cardType:d[e].cardType,id:d[e].id,phone:d[e].phone,isVaildCVV2:d[e].isVaildCVV2};a._initCrossData(),window.location.href="quick-pay.html"}else window.location.href="new-card.html"}else Ariel.Components.Pop.show("调起快捷支付失败，请重试")}})},initDefaultPaymentEvent:function(){var a=this;a._txtSafeCode=new Ariel.Components.Textfile({selector:a._wrapper.find(".safe-code"),pattern:/^\d{3}$/}),$(this._wrapper).find(".pay-false-btn").bind("tap",function(){Ariel.mpingEvent("JDCashierFastPay_PayFail",location.href),Common.Components.HelpDialog.show(Common.Components.HelpDialog.AGAIN_BIND_CARD)});var b="ontouchend"in document?"touchend":"click";$(this._wrapper).find(".choose-quick-pay").bind(b,function(b){Ariel.mpingEvent("JDCashierFastPay_SelectCards",location.href);var c=$(a._wrapper).find(".choose-quick-pay").find(".default-bank"),d=c.attr("data-acronym"),e=c.attr("data-card-type"),f=c.attr("data-last4-bit"),g=c.attr("data-card-id");Ariel.Components.BankList.setConfig({onEnter:function(b){a._setBindBank(b),a._pageScroller.refresh()},_displayName:function(b){return b.cardType||b.last4Bit?b.bankName+a._getCardTypeName(b.cardType)+"("+b.last4Bit+")":b.bankName},selectData:{acronym:d,cardType:e,last4Bit:f,cardId:g},dataModel:["agencyCode","bankName","acronym","cardId","last4Bit","cardType","id","phone","valid","isVaildCVV2"],data:a._getBindBanksData(),bandedBank:!0}),Ariel.Components.Loading.show(),setTimeout(function(){Ariel.Components.Loading.hide(),Ariel.Components.BankList.show()},320),b.preventDefault()}),$(this._wrapper).find(".safe-code-tip").bind("tap",function(){Ariel.mpingEvent("JDCashierFastPay_SecurityCodeInfo",location.href),Common.Components.HelpDialog.show(Common.Components.HelpDialog.HELP_FOR_SAFE_CODE)}),$(this._wrapper).find(".next").bind("tap",function(){var b=$(a._wrapper).find(".default-bank").attr("data-isVaildCVV2")?$(a._wrapper).find(".default-bank").attr("data-isVaildCVV2").toString():"true";if(Ariel.mpingEvent("JDCashierFastPay_Pay",location.href,a._cardType),2==$(a._wrapper).find(".default-bank").attr("data-card-type")&&!a._txtSafeCode.isValid()&&"false"!=b)return void Ariel.Components.Pop.show("请输入正确的安全码");var c=a._getSaveData();Ariel.Components.Loading.show(),a._saveData(a._getSaveData(),function(){a._sendMessageRequest(function(b){a._pollSendResult(b,function(){Ariel.Components.Loading.hide();var a=Ariel.parseGetParameters();Ariel.Courier.add(Common.DataKeys.ACROSS_PAGES_VERIFY_CODE_DATA,JSON.stringify({tel:c.phone,params:a,payType:"quick",finishData:{agencyCode:c.agencyCode}})),window.location.href="verify-code.html"})})})})},setDefaultDescription:function(){var a=this;a._data&&a._data.length>0&&(a._setBindBank(a._data[0]),a._pageScroller.refresh())},_getBindBanksData:function(){var a=this;return a._data},_getSaveData:function(){var a={},b=$(this._wrapper).find(".default-bank");return a.phone=b.attr("data-phone"),a.cardType=b.attr("data-card-type"),a.last4Bit=b.attr("data-last4-bit"),a.acronym=b.attr("data-acronym"),a.bankName=b.attr("data-bank-name"),a.agencyCode=b.attr("data-agency-code"),a.cardId=b.attr("data-card-id"),a.isVaildCVV2=b.attr("data-isVaildCVV2"),a},_saveData:function(a,b){var c=this,d=c._wrapper.find(".safe-code .textfile-input").val();Common.Net.ajax({url:"save.action",type:"POST",data:{cardId:a.cardId,agencyCode:a.agencyCode,bankName:a.bankName,bankNo:a.acronym,cardNoShort:a.last4Bit,cardType:a.cardType,phone:a.phone,cvv2:d?d:"111"},success:function(a){a.success?b&&b.call(c):(Ariel.Components.Loading.hide(),Ariel.Components.Pop.show("数据保存失败，请重试"))}})},_setBindBank:function(a){var b=this,c=$(b._wrapper).find(".default-bank"),d=a.isVaildCVV2?a.isVaildCVV2.toString():"true";switch(c.text("使用 "+a.bankName+" "+b._getCardTypeName(a.cardType)+"（"+a.last4Bit+"）"),c.attr("data-card-id",a.cardId),c.attr("data-agency-code",a.agencyCode),c.attr("data-bank-name",a.bankName),c.attr("data-acronym",a.acronym),c.attr("data-last4-bit",a.last4Bit),c.attr("data-card-type",a.cardType),c.attr("data-phone",a.phone),c.attr("data-isVaildCVV2",a.isVaildCVV2),parseInt(a.cardType)){case 1:b._wrapper.find(".safe-code-list").hide(),b._wrapper.find(".safe-code-list .textfile-input").val(""),b._cardType=b._DEBIT;break;case 2:b._cardType=b._CREDIT,"false"==d?b._wrapper.find(".safe-code-list").hide():$(b._wrapper).find(".safe-code-list").css("display","block")}},_getCardTypeName:function(a){switch(parseInt(a)){case 1:return"储蓄卡";case 2:return"信用卡";default:return""}},_sendMessageRequest:function(a){var b=this;Common.Net.ajax({url:"getPhoneCodeRegister.action",type:"POST",data:{phoneCodeFunc:"getVerifyCodeSecondPay"},success:function(c){c.success?a&&a.call(b,c.asyncTxnSequenceId):(Ariel.Components.Loading.hide(),Ariel.Components.Pop.show(c.info))}})},_pollSendResult:function(a,b,c){var d,e=this;if(c){if(3e3==c)c=5e3;else if(5e3==c)c=1e4;else if(1e4==c)return Ariel.Components.Loading.hide(),void Ariel.Components.Pop.show("短信发送失败，请重发")}else c=3e3;d=setTimeout(function(){Common.Net.ajax({url:"tradeStatus.action",type:"POST",data:{asyncTxnSequenceId:a,bindCardType:"1"},success:function(f){if(f.success){var g=Common.JSON.parse(f.originJson);1!=g.txnStatus?e._pollSendResult(a,b,c):b&&b.call(e)}else Ariel.Components.Loading.hide(),Ariel.Components.Pop.show(f.info);clearTimeout(d)}})},c)}}),BlankNotePayment=Ariel.extend(Payment,{_specialCss:"blank-note",_payType:"baiTiaoPay",_fingerPrint:null,_defaultTemplate:'<li class="list-item pay-list-item default-pay-list-item"><div class="pay-base-info-wrap"><span class="pay-icon"></span><span class="title-main">--</span><span class="available-money">可用额度：--.--元</span><span class="title-vice">--</span><a href="javascript:void(0);" class="blank-note-info canTap choose-stage-bar" data-stage="1" data-discountAmount="" data-interestFreeDays="30天免息"><span class="title">分期方式</span><span class="repayment right36px">--</span><span class="way">--</span></a><a href="javascript:void(0);" class="blank-note-info canTap choose-coupon-bar" data-couponNum="" data-activityId="" data-coupon-title="不使用优惠" data-plans="1,3,6,12,24"><span class="title">优惠方式</span><span class="coupons-number"></span><span class="selected-coupon-title right36px">不使用优惠</span></a><a href="javascript:void(0);" class="blank-note-info should-pay" data-shouldPay = {$baiTiaoPayPrice}><span class="title">白条应付</span><span class="use-coupon-should-pay">--元</span></a></div> <div class="next-wrap"><div class="blank-note-tip"><a class="blank-note-tip-icon tip-icon"></a></div><a href="javascript:void(0);" class="btn b-btn next">立即支付</a></div></li>  ',_interestFreeDays:"30天免息",startPayAction:function(){var a=this;a.addSidForBlankNotePay();try{a._fingerPrint=JSON.stringify(getJdEid()),a._initCrossData()}catch(b){}Ariel.Components.Loading.show(),window.location.href="blank-note.html"},addSidForBlankNotePay:function(){var a=Common.JSON.parse(Ariel.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA)),b=Ariel.parseGetParameters();b.sid&&(a.sid=b.sid,Ariel.Courier.add(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA,JSON.stringify(a)))},initDefaultPaymentEvent:function(){var a=this;a._data||{};Common.Components.BlankNoteLayers.updataCouponLayer(a._data);var b="ontouchend"in document?"touchend":"click";$(a._wrapper).find(".choose-stage-bar.canTap").bind(b,function(b){Ariel.Components.Loading.show();var c=$(a._wrapper).find(".choose-coupon-bar");return Ariel.mpingEvent("JDCashierIous_InstallmentType",location.href),$(a._wrapper).hasClass("disabled-pay-list-item")?void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop")):(0==$(".COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM").length?Common.Components.BlankNoteLayers.updataStageLayer({couponNum:c.attr("data-couponNum"),activityId:c.attr("data-activityId"),plans:c.attr("data-plans")},!1,!0):Common.Components.BlankNoteLayers.showStageLayer(),void(Common.Components.BlankNoteLayers.onSelectedStage=function(b){a._setBlankNoteStageBar(b)}))}),$(a._wrapper).find(".choose-coupon-bar.canTap").bind(b,function(b){Ariel.mpingEvent("MCashierPay_BlankNote",location.href),Common.Components.BlankNoteLayers.onSelectedCoupon=function(b){a._setBlankNoteCouponBar(b)},Common.Components.BlankNoteLayers.onUpdataStage=function(b){a._setBlankNoteStageBar(b)},Ariel.Components.Loading.show(),Common.Components.BlankNoteLayers.showCouponLayer()}),$(a._wrapper).find(".next").bind(b,function(b){var c=$(a._wrapper).find(".choose-coupon-bar").attr("data-couponNum"),d=$(a._wrapper).find(".choose-coupon-bar").attr("data-activityId"),e=$(a._wrapper).find(".way").attr("data-stage"),f={couponCode:c,installmentNum:e,activityId:$(a._wrapper).find(".choose-coupon-bar").attr("data-activityId"),discountAmount:$(a._wrapper).find(".choose-stage-bar").attr("data-discountAmount"),plans:c||d?$(a._wrapper).find(".choose-coupon-bar").attr("data-plans"):""};if(Ariel.mpingEvent("JDCashierIousSecurityVerify_Installment",location.href,e,c?"Y":"N"),$(a._wrapper).hasClass("disabled-pay-list-item"))return void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop"));if(a.addSidForBlankNotePay(),a._fingerPrint)"string"==typeof a._fingerPrint&&(a._fingerPrint=Common.JSON.parse(a._fingerPrint));else try{a._fingerPrint=getJdEid()}catch(b){a._fingerPrint={eid:"",fp:""}}Ariel.Components.Loading.show(),Common.Net.ajax({url:"getBaiTiaoIsUnPwdResult.action",type:"POST",data:{eid:a._fingerPrint.eid?a._fingerPrint.eid:"",fp:a._fingerPrint.fp?a._fingerPrint.fp:""},success:function(b){b.success?(f.isUnPwd=b.isUnPwd?b.isUnPwd:0,f.isShortPwd=b.isShortPwd?b.isShortPwd:0):(f.isUnPwd=0,f.isShortPwd=0),Ariel.Components.Loading.hide(),1==f.isUnPwd||1==f.isShortPwd?Common.Components.sixDigitPasswordBox.show({payType:"blank-note",data:f}):Common.Components.IdValidationMsgBox.show({payType:"blank-note",data:{couponCode:c,installmentNum:e,activityId:$(a._wrapper).find(".choose-coupon-bar").attr("data-activityId"),discountAmount:$(a._wrapper).find(".choose-stage-bar").attr("data-discountAmount"),plans:c||d?$(a._wrapper).find(".choose-coupon-bar").attr("data-plans"):""}})}})})},setDefaultDescription:function(){var a=this,b=a._data||{};this._resetBlankNoteType(),b&&b.balance&&$(a._wrapper).find(".available-money").html("可用额度</br>"+b.balance+"元"),3==a._status&&($(a._wrapper).addClass("disabled-pay-list-item").attr("data-pop",b.tip),$(a._wrapper).find(".blank-note-tip").append(b.tip)),a._total<10&&($(a._wrapper).find(".choose-stage-bar").removeClass("canTap"),$(a._wrapper).find(".choose-coupon-bar").removeClass("canTap")),-1==b.code&&$(a._wrapper).find(".choose-coupon-bar").hide(),1==a._status&&(0!=b.baiTiaoCounponText.length?(a._wrapper.find(".coupons-number").text(b.baiTiaoCounponText),a._wrapper.find(".coupons-number").show()):a._wrapper.find(".coupons-number").hide(),a._interestFreeDays=b.interestFreeDays,Common.Components.BlankNoteLayers.onInitCouponLayer=function(b){a._setBlankNoteCouponBar(b),a._setBlankNoteStageBar(b)},Common.Components.BlankNoteLayers.onUpdataStage=function(b){a._setBlankNoteStageBar(b)},Ariel.mpingEvent("MCashierPay_CouponAmoount",location.href,b.canUseCouponList.length?b.canUseCouponList.length:0))},_resetBlankNoteType:function(){Ariel.Courier.remove(Common.DataKeys.ACROSS_PAGES_BLANK_NOTE_STAGE_DATA)},_setBlankNoteStageBar:function(a){var b=this;_data={stage:a.stage||1,repayment:a.repayment||b._total,shouldPay:a.shouldPay||b._total,discountAmount:a.discountAmount||""};var c=b._wrapper.find(".choose-stage-bar");1==parseInt(_data.stage)?(c.find(".way").text(b._interestFreeDays).attr("data-stage","1"),c.find(".repayment").text("应还金额 "+_data.repayment+" 元")):(c.find(".way").text("分"+_data.stage+"期").attr("data-stage",_data.stage),c.find(".repayment").text("每期"+_data.repayment+"元")),c.attr("data-stage",_data.stage),c.attr("data-interestFreeDays",b._interestFreeDays),c.attr("data-repayment",_data.repayment),b._wrapper.find(".use-coupon-should-pay").text(_data.shouldPay+"元"),b._wrapper.find(".should-pay").attr("data-shouldPay",_data.shouldPay),c.attr("data-discountAmount",_data.discountAmount)},_setBlankNoteCouponBar:function(a){var b=this,c=b._wrapper.find(".choose-coupon-bar");c.find(".selected-coupon-title").text(a.couponInfo),c.attr("data-couponTitle",a.couponInfo),c.attr("data-couponNum",a.couponNum),c.attr("data-activityId",a.activityId),c.attr("data-plans",a.plans)}}),GlobalBlankNotePayment=Ariel.extend(Payment,{_specialCss:"blank-note",_payType:"baiTiaoPay",_defaultTemplate:'<li class="list-item pay-list-item default-pay-list-item"><div class="pay-base-info-wrap"><span class="pay-icon"></span><span class="title-main">--</span><span class="available-money">可用额度：--.--元</span><span class="title-vice">--</span><a href="javascript:void(0);" class="blank-note-info canTap choose-stage-bar" data-stage="1" data-discountAmount="" data-interestFreeDays="30天免息"><span class="title">分期方式</span><span class="repayment right36px">--</span><span class="way">--</span></a><a href="javascript:void(0);" class="blank-note-info canTap choose-coupon-bar" data-couponNum="" data-activityId="" data-couponTitle="不使用优惠" data-plans="1,3,6,12,24"><span class="title">优惠方式</span><span class="coupons-number"></span><span class="selected-coupon-title right36px">不使用优惠</span></a><a href="javascript:void(0);" class="blank-note-info should-pay" data-shouldPay = {$baiTiaoPayPrice}><span class="title">白条应付</span><span class="use-coupon-should-pay">--元</span></a></div> <div class="next-wrap"><div class="blank-note-tip"><a class="blank-note-tip-icon tip-icon"></a></div><a href="javascript:void(0);" class="btn b-btn next">立即支付</a></div></li>  ',startPayAction:function(){var a=this;a.addSidForBlankNotePay(),window.location.href="global-blank-note.html"},addSidForBlankNotePay:function(){var a=Common.JSON.parse(Ariel.Courier.get(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA)),b=Ariel.parseGetParameters();b.sid&&(a.sid=b.sid,Ariel.Courier.add(Common.DataKeys.ACROSS_PAGES_PAY_REQUEST_DATA,JSON.stringify(a)))},initDefaultPaymentEvent:function(){var a=this;Common.Components.GlobalBlankNoteLayers.updataCouponLayer(a._data);var b="ontouchend"in document?"touchend":"click";$(a._wrapper).find(".choose-stage-bar.canTap").bind(b,function(b){Ariel.Components.Loading.show();var c=$(a._wrapper).find(".choose-coupon-bar");return Ariel.mpingEvent("JDCashierIous_InstallmentType",location.href),$(a._wrapper).hasClass("disabled-pay-list-item")?void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop")):(0==$(".COMM_BLANK_NOTE_STAGE_LAYER_LIST_ITEM").length?Common.Components.GlobalBlankNoteLayers.updataStageLayer({couponNum:c.attr("data-couponNum"),activityId:c.attr("data-activityId"),plans:c.attr("data-plans")},!1,!0):Common.Components.GlobalBlankNoteLayers.showStageLayer(),void(Common.Components.GlobalBlankNoteLayers.onSelectedStage=function(b){a._setBlankNoteStageBar(b)}))}),$(a._wrapper).find(".choose-coupon-bar.canTap").bind(b,function(b){Ariel.mpingEvent("MCashierPay_BlankNote",location.href),Common.Components.GlobalBlankNoteLayers.onSelectedCoupon=function(b){a._setBlankNoteCouponBar(b)},Common.Components.GlobalBlankNoteLayers.onUpdataStage=function(b){a._setBlankNoteStageBar(b)},Ariel.Components.Loading.show(),Common.Components.GlobalBlankNoteLayers.showCouponLayer()}),$(a._wrapper).find(".next").bind(b,function(b){var c=$(a._wrapper).find(".choose-coupon-bar").attr("data-couponNum"),d=$(a._wrapper).find(".choose-coupon-bar").attr("data-activityId"),e=$(a._wrapper).find(".way").attr("data-stage");return Ariel.mpingEvent("JDCashierIousSecurityVerify_Installment",location.href,e,c?"Y":"N"),$(a._wrapper).hasClass("disabled-pay-list-item")?void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop")):(a.addSidForBlankNotePay(),Ariel.Components.Loading.show(),void setTimeout(function(){Ariel.Components.Loading.hide(),Common.Components.IdValidationMsgBox.show({payType:"blank-note",data:{couponCode:c,installmentNum:e,activityId:d,discountAmount:$(a._wrapper).find(".choose-stage-bar").attr("data-discountAmount"),plans:c||d?$(a._wrapper).find(".choose-coupon-bar").attr("data-plans"):"",activityType:$(a._wrapper).find(".choose-coupon-bar").attr("data-activityType")}})},320))})},setDefaultDescription:function(){var a=this,b=a._data||{};this._resetBlankNoteType(),b&&b.balance&&$(a._wrapper).find(".available-money").html("可用额度</br>"+b.balance+"元"),3==a._status&&($(a._wrapper).addClass("disabled-pay-list-item").attr("data-pop",b.tip),$(a._wrapper).find(".blank-note-tip").append(b.tip)),a._total<10&&($(a._wrapper).find(".choose-stage-bar").removeClass("canTap"),$(a._wrapper).find(".choose-coupon-bar").removeClass("canTap")),-1==b.code&&$(a._wrapper).find(".choose-coupon-bar").hide(),1==a._status&&(0!=b.baiTiaoCounponText.length?(a._wrapper.find(".coupons-number").text(b.baiTiaoCounponText),a._wrapper.find(".coupons-number").show()):a._wrapper.find(".coupons-number").hide(),a._interestFreeDays=b.interestFreeDays,Common.Components.GlobalBlankNoteLayers.onInitCouponLayer=function(b){a._setBlankNoteCouponBar(b),a._setBlankNoteStageBar(b)},Common.Components.GlobalBlankNoteLayers.onUpdataStage=function(b){a._setBlankNoteStageBar(b)},Ariel.mpingEvent("MCashierPay_CouponAmoount",location.href,b.canUseCouponList.length?b.canUseCouponList.length:0))},_resetBlankNoteType:function(){Ariel.Courier.remove(Common.DataKeys.ACROSS_PAGES_BLANK_NOTE_STAGE_DATA)},_setBlankNoteStageBar:function(a){var b=this,c={stage:a.stage||1,repayment:a.repayment||b._total,shouldPay:a.shouldPay||b._total,discountAmount:a.discountAmount||""},d=b._wrapper.find(".choose-stage-bar");1==parseInt(c.stage)?(d.find(".way").text(b._interestFreeDays).attr("data-stage","1"),d.find(".repayment").text("应还金额 "+c.repayment+" 元")):(d.find(".way").text("分"+c.stage+"期").attr("data-stage",c.stage),d.find(".repayment").text("每期"+c.repayment+"元")),
d.attr("data-stage",c.stage),d.attr("data-interestFreeDays",b._interestFreeDays),d.attr("data-repayment",c.repayment),b._wrapper.find(".use-coupon-should-pay").text(c.shouldPay+"元"),b._wrapper.find(".should-pay").attr("data-shouldPay",c.shouldPay),d.attr("data-discountAmount",c.discountAmount)},_setBlankNoteCouponBar:function(a){var b=this,c=b._wrapper.find(".choose-coupon-bar");c.find(".selected-coupon-title").text(a.couponInfo),c.attr("data-couponTitle",a.couponInfo),c.attr("data-couponNum",a.couponNum),c.attr("data-activityId",a.activityId),c.attr("data-plans",a.plans),c.attr("data-activityType",a.activityType)}}),CofferPayment=Ariel.extend(Payment,{_specialCss:"coffer",_payType:"cofferPay",_defaultTemplate:'<li class="list-item pay-list-item default-pay-list-item coffer"><div class="pay-base-info-wrap"><span class="pay-icon"></span><span class="title-main">--</span><span class="title-vice">--</span></div><ul class="list coffer-list COMM_SIMULATION_1PX_DASHED_BORDER"><li class="list-item"><a href="javascript:void(0);" data-agency-code="185" class="crl-radio coffer-way checked"></a><span class="title">京东小金库</span><span class="available-money coffer-available-money">可用余额：--.--元</span></li><li class="list-item"><a href="javascript:void(0);" data-agency-code="186" class="crl-radio coffer-way"></a><span class="title">京东钱包余额</span><span class="available-money net-bank-available-money">可用余额：--.--元</span></li></ul><div class="next-wrap"><div class="coffer-tip"><a class="coffer-tip-icon tip-icon"></a></div><a href="javascript:void(0);" class="btn b-btn next">立即支付</a></div></li>   ',startPayAction:function(){window.location.href="coffer.html"},initDefaultPaymentEvent:function(){var a=this;$(a._wrapper).find(".coffer-list").delegate(".list-item","tap",function(){var b=a._data.walletIsEnough;return b&&0==b?void Ariel.Components.Pop.show("京东钱包余额不足"):($(a._wrapper).find(".coffer-way").removeClass("checked"),void $(this).find(".coffer-way").addClass("checked"))}),$(a._wrapper).find(".next").bind("tap",function(){return $(a._wrapper).hasClass("disabled-pay-list-item")?void Ariel.Components.Pop.show($(a._wrapper).attr("data-pop")):void Common.Components.IdValidationMsgBox.show({payType:"coffer",data:{agencyCode:$(a._wrapper).find(".coffer-way.checked").attr("data-agency-code")}})})},setDefaultDescription:function(){var a=this,b=a._data||{};b.balance&&$(a._wrapper).find(".coffer-available-money").attr("coffer-balance",b.balance).text("可用余额："+b.balance+"元"),b.walletBalance&&$(a._wrapper).find(".net-bank-available-money").attr("net-bank-balance",b.walletBalance).text("可用余额："+b.walletBalance+"元"),b.balance&&$(a._wrapper).find(".available-money").text("可用余额："+b.balance+"元"),3==a._status&&$(a._wrapper).find(".coffer-tip").append(b.tip)}});